<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>合同存证 | Cups</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Fabric">
    <meta name="description" content="（一）业务流程（二）组织、域名、ip匹配表   域名 ip地址 组织 内网ip    ca.root.com 192.168.30.2 platform 123   ca.court.com 192.168.30.3 court 123   ca.user.com 192.168.30.4 user 123   order0.court.com 192.168.30.5 court 123   o">
<meta name="keywords" content="Fabric">
<meta property="og:type" content="article">
<meta property="og:title" content="合同存证">
<meta property="og:url" content="http:&#x2F;&#x2F;cupswen.github.io&#x2F;2020&#x2F;10&#x2F;05&#x2F;2020&#x2F;contract-deposit&#x2F;index.html">
<meta property="og:site_name" content="Cups">
<meta property="og:description" content="（一）业务流程（二）组织、域名、ip匹配表   域名 ip地址 组织 内网ip    ca.root.com 192.168.30.2 platform 123   ca.court.com 192.168.30.3 court 123   ca.user.com 192.168.30.4 user 123   order0.court.com 192.168.30.5 court 123   o">
<meta property="og:locale" content="en">
<meta property="og:image" content="http:&#x2F;&#x2F;cupswen.github.io&#x2F;img&#x2F;contract-deposit&#x2F;map.png">
<meta property="og:image" content="http:&#x2F;&#x2F;cupswen.github.io&#x2F;img&#x2F;contract-deposit&#x2F;pem.png">
<meta property="og:updated_time" content="2020-10-07T03:27:49.203Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http:&#x2F;&#x2F;cupswen.github.io&#x2F;img&#x2F;contract-deposit&#x2F;map.png">
    
    <link rel="shortcut icon" href="/img/brand.jpg">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/the_Huanghe_River.png">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">CupsWen</h5>
          <a href="mailto:1191567189@qq.com" target="_blank" rel="noopener" title="1191567189@qq.com" class="mail">1191567189@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/index.html"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/CupsWen" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://cupswen.github.io/hyperlink"  >
                <i class="icon icon-lg icon-link"></i>
                Link
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">合同存证</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">合同存证</h1>
        <h5 class="subtitle">
            
                <time datetime="2020-10-05T12:14:10.000Z" itemprop="datePublished" class="page-time">
  2020-10-05
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Fabric/">Fabric</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#（一）业务流程"><span class="post-toc-text">（一）业务流程</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#（二）组织、域名、ip匹配表"><span class="post-toc-text">（二）组织、域名、ip匹配表</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#（三）网络"><span class="post-toc-text">（三）网络</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#（四）虚拟机"><span class="post-toc-text">（四）虚拟机</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1、防火墙"><span class="post-toc-text">1、防火墙</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2、hosts文件"><span class="post-toc-text">2、hosts文件</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3、镜像1-4-3"><span class="post-toc-text">3、镜像1.4.3</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#4、bin文件1-4-3"><span class="post-toc-text">4、bin文件1.4.3</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#（五）CA"><span class="post-toc-text">（五）CA</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#1、根证书"><span class="post-toc-text">1、根证书</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#2、ca-root-com（192-168-30-2）"><span class="post-toc-text">2、ca.root.com（192.168.30.2）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（1）ca-root-com-config-yaml"><span class="post-toc-text">（1）ca.root.com-config.yaml</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（2）ca-root-com-yaml"><span class="post-toc-text">（2）ca.root.com.yaml</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（3）启动ca-root-com"><span class="post-toc-text">（3）启动ca.root.com</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（4）登记注册"><span class="post-toc-text">（4）登记注册</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#3、ca-court-com（192-168-30-3）"><span class="post-toc-text">3、ca.court.com（192.168.30.3）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（1）ca-court-com-config-yaml"><span class="post-toc-text">（1）ca.court.com-config.yaml</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（2）初始化"><span class="post-toc-text">（2）初始化</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（3）ca-court-com-yaml"><span class="post-toc-text">（3）ca.court.com.yaml</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（4）启动ca-court-com"><span class="post-toc-text">（4）启动ca.court.com</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（5）登记注册"><span class="post-toc-text">（5）登记注册</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#4、ca-user-com（192-168-30-4）"><span class="post-toc-text">4、ca.user.com（192.168.30.4）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（1）ca-user-com-config-yaml"><span class="post-toc-text">（1）ca.user.com-config.yaml</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（2）初始化-1"><span class="post-toc-text">（2）初始化</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（3）ca-user-com-yaml"><span class="post-toc-text">（3）ca.user.com.yaml</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（4）启动ca-user-com"><span class="post-toc-text">（4）启动ca.user.com</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（5）登记注册-1"><span class="post-toc-text">（5）登记注册</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#5、证书组织"><span class="post-toc-text">5、证书组织</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（1）登记配置文件编写"><span class="post-toc-text">（1）登记配置文件编写</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（2）登记"><span class="post-toc-text">（2）登记</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#（五）常用命令"><span class="post-toc-text">（五）常用命令</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#删除用户"><span class="post-toc-text">删除用户</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#证书链"><span class="post-toc-text">证书链</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#清空所有容器"><span class="post-toc-text">清空所有容器</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#清空所有镜像"><span class="post-toc-text">清空所有镜像</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#清理挂载卷"><span class="post-toc-text">清理挂载卷</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#清理项目文件"><span class="post-toc-text">清理项目文件</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-2020/contract-deposit"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">合同存证</h1>
        <div class="post-meta">
            <time class="post-time" title="2020-10-05 20:14:10" datetime="2020-10-05T12:14:10.000Z"  itemprop="datePublished">2020-10-05</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Fabric/">Fabric</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="（一）业务流程"><a href="#（一）业务流程" class="headerlink" title="（一）业务流程"></a>（一）业务流程</h1><h1 id="（二）组织、域名、ip匹配表"><a href="#（二）组织、域名、ip匹配表" class="headerlink" title="（二）组织、域名、ip匹配表"></a>（二）组织、域名、ip匹配表</h1><table>
<thead>
<tr>
<th align="left">域名</th>
<th>ip地址</th>
<th align="center">组织</th>
<th align="center">内网ip</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ca.root.com</td>
<td>192.168.30.2</td>
<td align="center">platform</td>
<td align="center">123</td>
</tr>
<tr>
<td align="left">ca.court.com</td>
<td>192.168.30.3</td>
<td align="center">court</td>
<td align="center">123</td>
</tr>
<tr>
<td align="left">ca.user.com</td>
<td>192.168.30.4</td>
<td align="center">user</td>
<td align="center">123</td>
</tr>
<tr>
<td align="left">order0.court.com</td>
<td>192.168.30.5</td>
<td align="center">court</td>
<td align="center">123</td>
</tr>
<tr>
<td align="left">order1.court.com</td>
<td>192.168.30.6</td>
<td align="center">court</td>
<td align="center">123</td>
</tr>
<tr>
<td align="left">order.user.com</td>
<td>192.168.30.7</td>
<td align="center">user</td>
<td align="center">123</td>
</tr>
<tr>
<td align="left">peer0.court.com</td>
<td>192.168.30.8</td>
<td align="center">court</td>
<td align="center">123</td>
</tr>
<tr>
<td align="left">peer0.user.com</td>
<td>192.168.30.9</td>
<td align="center">user</td>
<td align="center">123</td>
</tr>
</tbody></table>
<h1 id="（三）网络"><a href="#（三）网络" class="headerlink" title="（三）网络"></a>（三）网络</h1><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/img/contract-deposit/map.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="（四）虚拟机"><a href="#（四）虚拟机" class="headerlink" title="（四）虚拟机"></a>（四）虚拟机</h1><h2 id="1、防火墙"><a href="#1、防火墙" class="headerlink" title="1、防火墙"></a>1、防火墙</h2><h2 id="2、hosts文件"><a href="#2、hosts文件" class="headerlink" title="2、hosts文件"></a>2、hosts文件</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">192.168.30.2 ca.root.com </span><br><span class="line">192.168.30.3 ca.court.com </span><br><span class="line">192.168.30.4 ca.user.com </span><br><span class="line">192.168.30.5 order0.court.com </span><br><span class="line">192.168.30.6 order1.court.com </span><br><span class="line">192.168.30.7 order.user.com </span><br><span class="line">192.168.30.8 peer0.court.com </span><br><span class="line">192.168.30.9 peer0.user.com</span><br></pre></td></tr></table></figure>

<h2 id="3、镜像1-4-3"><a href="#3、镜像1-4-3" class="headerlink" title="3、镜像1.4.3"></a>3、镜像1.4.3</h2><h2 id="4、bin文件1-4-3"><a href="#4、bin文件1-4-3" class="headerlink" title="4、bin文件1.4.3"></a>4、bin文件1.4.3</h2><h1 id="（五）CA"><a href="#（五）CA" class="headerlink" title="（五）CA"></a>（五）CA</h1><h2 id="1、根证书"><a href="#1、根证书" class="headerlink" title="1、根证书"></a>1、根证书</h2><blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 生成私钥</span></span><br><span class="line">openssl ecparam -genkey -name secp256r1 |openssl ec -out ca.key.pem</span><br><span class="line"><span class="meta">#</span><span class="bash"> 转换为pkcs8格式</span></span><br><span class="line">openssl pkcs8 -topk8 -inform PEM -in ca.key.pem -outform PEM -nocrypt</span><br><span class="line"><span class="meta">#</span><span class="bash"> 复制输出到原私钥文件</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 生成自认证证书</span></span><br><span class="line">openssl req -config openssl.cnf -key ca.key.pem -new -x509 -days 7300 -sha256 -extensions v3_ca -out ca.cert.pem</span><br></pre></td></tr></table></figure>

<p>命令行输出如下：</p>
<p>最终生成ca.key.pem和ca.cert.pem。</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\cups&gt;openssl ecparam -genkey -name secp256r1 |openssl ec -out ca.key.pem</span><br><span class="line">using curve name prime256v1 instead of secp256r1</span><br><span class="line">read EC key</span><br><span class="line">writing EC key</span><br><span class="line"></span><br><span class="line">C:\Users\cups&gt;openssl pkcs8 -topk8 -inform PEM -in ca.key.pem -outform PEM -nocrypt</span><br><span class="line">-----BEGIN PRIVATE KEY-----</span><br><span class="line">MIGHAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBG0wawIBAQQgJzm3ch3diRqrrH1V</span><br><span class="line">lyYGOuXTbiC3TSDmfZwj3k4EJwWhRANCAAR4GgdmlH+GWMZcnVQAvUTmbIBWIAz8</span><br><span class="line">dC0zuAhhWzfgmLq3UadZotEbvEv3S0vue9bF/+qBBxttSqnKv7Xsd9yG</span><br><span class="line">-----END PRIVATE KEY-----</span><br><span class="line"></span><br><span class="line">C:\Users\cups&gt;openssl req -config openssl.cnf -key ca.key.pem -new -x509 -days 7300 -sha256 -extensions v3_ca -out ca.cert.pem</span><br><span class="line">You are about to be asked to enter information that will be incorporated</span><br><span class="line">into your certificate request.</span><br><span class="line">What you are about to enter is what is called a Distinguished Name or a DN.</span><br><span class="line">There are quite a few fields but you can leave some blank</span><br><span class="line">For some fields there will be a default value,</span><br><span class="line">If you enter '.', the field will be left blank.</span><br><span class="line">-----</span><br><span class="line">Country Name (2 letter code) [CN]:CN</span><br><span class="line">State or Province Name [China]:HeNan</span><br><span class="line">Locality Name []:ZhengZhou</span><br><span class="line">Organization Name [Hyperledger]:ZUT</span><br><span class="line">Organizational Unit Name [Fabric]:QY</span><br><span class="line">Common Name [fabric-ca-server]:</span><br><span class="line">Email Address []:</span><br><span class="line"></span><br><span class="line">C:\Users\cups&gt;</span><br></pre></td></tr></table></figure>

<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/img/contract-deposit/pem.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h2 id="2、ca-root-com（192-168-30-2）"><a href="#2、ca-root-com（192-168-30-2）" class="headerlink" title="2、ca.root.com（192.168.30.2）"></a>2、ca.root.com（192.168.30.2）</h2><h3 id="（1）ca-root-com-config-yaml"><a href="#（1）ca-root-com-config-yaml" class="headerlink" title="（1）ca.root.com-config.yaml"></a>（1）ca.root.com-config.yaml</h3><blockquote>
<p>路径：contract-deposit/ca.root.com/ca.root.com-config.yaml。</p>
<p>功能：配置ca。</p>
<p>配置文件各部分含义见：<a href="https://blog.csdn.net/greedystar/article/details/80344984" target="_blank" rel="noopener">https://blog.csdn.net/greedystar/article/details/80344984</a></p>
<p>文档过长，下面列出修改的部分。</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 版本号与镜像版本号对应</span></span><br><span class="line">version: 1.4.3</span><br><span class="line"><span class="meta">#</span><span class="bash"> 指定ca名称、私钥、证书、证书链</span></span><br><span class="line">ca:</span><br><span class="line">  name: ca.root.com</span><br><span class="line">  keyfile: ./msp/ca.key.pem</span><br><span class="line">  certfile: ./msp/ca.cert.pem</span><br><span class="line">  chainfile: ./msp/ca.cert.pem</span><br><span class="line"><span class="meta">#</span><span class="bash"> 指定组织结构</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 虽然可以使用fabric-ca-server来进行动态修改,直接改好省事</span></span><br><span class="line">affiliations:</span><br><span class="line">   court:</span><br><span class="line">      - department1</span><br><span class="line">      - department2</span><br><span class="line">   user:</span><br><span class="line">      - department1</span><br><span class="line"><span class="meta">#</span><span class="bash"> 证书签名请求</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> cn通用名称一般不写,因为容易出现重复被ca拒绝</span></span><br><span class="line">csr:</span><br><span class="line">   cn:</span><br><span class="line">   keyrequest:</span><br><span class="line">     algo: ecdsa</span><br><span class="line">     size: 256</span><br><span class="line">   names:</span><br><span class="line">      - C: CN</span><br><span class="line">        ST: HeNan</span><br><span class="line">        L: ZhengZhou</span><br><span class="line">        O: Platform</span><br><span class="line">        OU: CA</span><br><span class="line">   hosts:</span><br><span class="line">     - ca.root.com</span><br><span class="line">     - localhost</span><br><span class="line">   ca:</span><br><span class="line">      expiry: 131400h</span><br><span class="line">      pathlength: 1</span><br></pre></td></tr></table></figure>

<h3 id="（2）ca-root-com-yaml"><a href="#（2）ca-root-com-yaml" class="headerlink" title="（2）ca.root.com.yaml"></a>（2）ca.root.com.yaml</h3><blockquote>
<p>Fabric环境变量请参考：<a href="http://cw.hubwiz.com/card/c/fabric-env-manual/" target="_blank" rel="noopener">http://cw.hubwiz.com/card/c/fabric-env-manual/</a></p>
<p>注意网络：contract-deposit。</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">version: '2'</span><br><span class="line">services:</span><br><span class="line">  ca.root.com:</span><br><span class="line">    container_name: ca.root.com</span><br><span class="line">    image: hyperledger/fabric-ca:1.4.3</span><br><span class="line">    environment:</span><br><span class="line">      - FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server</span><br><span class="line">      - FABRIC_CA_SERVER_CA_NAME=ca.root.com</span><br><span class="line">      - FABRIC_CA_SERVER_TLS_ENABLED=false</span><br><span class="line">    ports:</span><br><span class="line">      - "7054:7054"</span><br><span class="line">    command: sh -c 'fabric-ca-server start -c /etc/hyperledger/fabric-ca-server/ca.root.com-config.yaml --cfg.affiliations.allowremove --cfg.identities.allowremove -d'</span><br><span class="line">    volumes:</span><br><span class="line">      - ./ca.root.com/:/etc/hyperledger/fabric-ca-server</span><br><span class="line">    networks:</span><br><span class="line">      default:</span><br><span class="line">        aliases:</span><br><span class="line">          - contract-deposit</span><br></pre></td></tr></table></figure>

<h3 id="（3）启动ca-root-com"><a href="#（3）启动ca-root-com" class="headerlink" title="（3）启动ca.root.com"></a>（3）启动ca.root.com</h3><blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 启动容器</span></span><br><span class="line">docker-compose -f ca.root.com.yaml up -d</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看容器</span></span><br><span class="line">docker ps</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看日志</span></span><br><span class="line">docker logs ca.root.com</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@vm192168302 contract-deposit]#  docker-compose -f ca.root.com.yaml up -d</span><br><span class="line">Creating network "contract-deposit_default" with the default driver</span><br><span class="line">Creating ca.root.com ... done</span><br><span class="line">[root@vm192168302 contract-deposit]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE                         COMMAND                  CREATED             STATUS              PORTS                    NAMES</span><br><span class="line">29ec30adfd59        hyperledger/fabric-ca:1.4.3   "sh -c 'fabric-ca-se…"   7 seconds ago       Up 6 seconds        0.0.0.0:7054-&gt;7054/tcp   ca.root.com</span><br><span class="line">[root@vm192168302 contract-deposit]#</span><br></pre></td></tr></table></figure>

<h3 id="（4）登记注册"><a href="#（4）登记注册" class="headerlink" title="（4）登记注册"></a>（4）登记注册</h3><blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 引导账户</span></span><br><span class="line">export FABRIC_CA_CLIENT_HOME=./root-ca-admin</span><br><span class="line">fabric-ca-client enroll -u http://admin:adminpw@192.168.30.2:7054</span><br><span class="line"><span class="meta">#</span><span class="bash"> 注册 ca.court.com</span></span><br><span class="line">export FABRIC_CA_CLIENT_HOME=./root-ca-admin</span><br><span class="line">fabric-ca-client register --id.name ca.court.com --id.secret ca.court.com.pw --id.affiliation court.department1 --id.attrs 'hf.IntermediateCA=true:ecert'</span><br><span class="line"><span class="meta">#</span><span class="bash"> 注册 ca.user.com</span></span><br><span class="line">export FABRIC_CA_CLIENT_HOME=./root-ca-admin</span><br><span class="line">fabric-ca-client register --id.name ca.user.com --id.secret ca.user.com.pw  --id.affiliation user.department1 --id.attrs 'hf.IntermediateCA=true:ecert'</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@vm192168302 contract-deposit]# export FABRIC_CA_CLIENT_HOME=./root-ca-admin</span><br><span class="line">[root@vm192168302 contract-deposit]# fabric-ca-client enroll -u http://admin:adminpw@192.168.30.2:7054</span><br><span class="line">2020/10/07 09:42:37 [INFO] generating key: &amp;&#123;A:ecdsa S:256&#125;</span><br><span class="line">2020/10/07 09:42:37 [INFO] encoded CSR</span><br><span class="line">2020/10/07 09:42:37 [INFO] Stored client certificate at /root/contract-deposit/root-ca-admin/AdminMSP/signcerts/cert.pem</span><br><span class="line">2020/10/07 09:42:37 [INFO] Stored root CA certificate at /root/contract-deposit/root-ca-admin/AdminMSP/cacerts/192-168-30-2-7054.pem</span><br><span class="line">2020/10/07 09:42:37 [INFO] Stored Issuer public key at /root/contract-deposit/root-ca-admin/AdminMSP/IssuerPublicKey</span><br><span class="line">2020/10/07 09:42:37 [INFO] Stored Issuer revocation public key at /root/contract-deposit/root-ca-admin/AdminMSP/IssuerRevocationPublicKey</span><br><span class="line">[root@vm192168302 contract-deposit]# export FABRIC_CA_CLIENT_HOME=./root-ca-admin</span><br><span class="line">[root@vm192168302 contract-deposit]# fabric-ca-client register --id.name ca.court.com --id.secret ca.court.com.pw --id.affiliation court.department1 --id.attrs 'hf.IntermediateCA=true:ecert'</span><br><span class="line">2020/10/07 09:43:01 [INFO] Configuration file location: /root/contract-deposit/root-ca-admin/fabric-ca-client-config.yaml</span><br><span class="line">Password: ca.court.com.pw</span><br><span class="line">[root@vm192168302 contract-deposit]# export FABRIC_CA_CLIENT_HOME=./root-ca-admin</span><br><span class="line">[root@vm192168302 contract-deposit]# fabric-ca-client register --id.name ca.user.com --id.secret ca.user.com.pw  --id.affiliation user.department1 --id.attrs 'hf.IntermediateCA=true:ecert'</span><br><span class="line">2020/10/07 09:43:11 [INFO] Configuration file location: /root/contract-deposit/root-ca-admin/fabric-ca-client-config.yaml</span><br><span class="line">Password: ca.user.com.pw</span><br><span class="line">[root@vm192168302 contract-deposit]#</span><br></pre></td></tr></table></figure>

<h2 id="3、ca-court-com（192-168-30-3）"><a href="#3、ca-court-com（192-168-30-3）" class="headerlink" title="3、ca.court.com（192.168.30.3）"></a>3、ca.court.com（192.168.30.3）</h2><h3 id="（1）ca-court-com-config-yaml"><a href="#（1）ca-court-com-config-yaml" class="headerlink" title="（1）ca.court.com-config.yaml"></a>（1）ca.court.com-config.yaml</h3><blockquote>
<p>路径：contract-deposit/ca.court.com/ca.court.com-config.yaml。</p>
<p>功能：配置ca。</p>
<p>配置文件各部分含义见：<a href="https://blog.csdn.net/greedystar/article/details/80344984" target="_blank" rel="noopener">https://blog.csdn.net/greedystar/article/details/80344984</a></p>
<p>文档过长，下面列出修改的部分。</p>
<blockquote>
<p>有人可能会问不需要配置ca名称、私钥、公钥、证书链的吗？？？</p>
<p>有兴趣的可以尝试先申请证书（ca.court.com_msp），再把证书组织到一定位置，改动配置文件，使用docker-compose或者fabric-ca-server来启动。</p>
<p>会遇到下边两个问题：1、如何申请证书链。2、为啥ca证书认证失败（ca不认管理员）。</p>
<p>对于ca名称，ca.court.com.yaml中的配置是高于配置文件中的配置的，会被程序执行。</p>
<p>对于私钥、公钥、证书链，采用默认位置就好（中间ca的资料这么少，瞎搞容易出问题）。</p>
</blockquote>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 版本</span></span><br><span class="line">version: 1.4.3</span><br><span class="line"><span class="meta">#</span><span class="bash"> 组织</span></span><br><span class="line">affiliations:</span><br><span class="line">   court:</span><br><span class="line">      - department1</span><br><span class="line">      - department2</span><br><span class="line"><span class="meta">#</span><span class="bash"> 签名请求</span></span><br><span class="line">csr:</span><br><span class="line">   cn:</span><br><span class="line">   keyrequest:</span><br><span class="line">     algo: ecdsa</span><br><span class="line">     size: 256</span><br><span class="line">   names:</span><br><span class="line">      - C: CN</span><br><span class="line">        ST: HeNan</span><br><span class="line">        L: ZhengZhou</span><br><span class="line">        O: Court</span><br><span class="line">        OU: CA</span><br><span class="line">   hosts:</span><br><span class="line">     - ca.court.com</span><br><span class="line">     - localhost</span><br><span class="line">   ca:</span><br><span class="line">      expiry: 131400h</span><br><span class="line">      pathlength: 0</span><br><span class="line"><span class="meta">#</span><span class="bash"> 中间ca</span></span><br><span class="line">intermediate:</span><br><span class="line">  parentserver:</span><br><span class="line">    url: ca.root.com:7054</span><br><span class="line">    caname: ca.root.com</span><br></pre></td></tr></table></figure>

<h3 id="（2）初始化"><a href="#（2）初始化" class="headerlink" title="（2）初始化"></a>（2）初始化</h3><blockquote>
<p>使用fabric-ca-server按照ca.court.com-config.yaml对当前ca进行初始化；</p>
<p>指定引导用户为admin:adminpw；</p>
<p>指定ca证书来自<a href="http://ca.court.com:ca.court.com.pw@192.168.30.2:7054。" target="_blank" rel="noopener">http://ca.court.com:ca.court.com.pw@192.168.30.2:7054。</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 登记 + 初始化</span></span><br><span class="line">fabric-ca-server init \</span><br><span class="line">-b admin:adminpw \</span><br><span class="line">-u http://ca.court.com:ca.court.com.pw@192.168.30.2:7054 \</span><br><span class="line">-c ./ca.court.com-config.yaml</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">[root@vm192168303 contract-deposit]# cd ca.court.com/</span><br><span class="line">[root@vm192168303 ca.court.com]# fabric-ca-server init \</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -b admin:adminpw \</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -u http://ca.court.com:ca.court.com.pw@192.168.30.2:7054 \</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -c ./ca.court.com-config.yaml</span></span><br><span class="line">2020/10/07 09:59:47 [INFO] Configuration file location: /root/contract-deposit/ca.court.com/ca.court.com-config.yaml</span><br><span class="line">2020/10/07 09:59:47 [INFO] Server Version: 1.4.6</span><br><span class="line">2020/10/07 09:59:47 [INFO] Server Levels: &amp;&#123;Identity:2 Affiliation:1 Certificate:1 Credential:1 RAInfo:1 Nonce:1&#125;</span><br><span class="line">2020/10/07 09:59:47 [WARNING] &amp;&#123;69 The specified CA certificate file /root/contract-deposit/ca.court.com/ca-cert.pem does not exist&#125;</span><br><span class="line">2020/10/07 09:59:47 [INFO] generating key: &amp;&#123;A:ecdsa S:256&#125;</span><br><span class="line">2020/10/07 09:59:47 [INFO] encoded CSR</span><br><span class="line">2020/10/07 09:59:47 [INFO] The CA key and certificate were generated for CA </span><br><span class="line">2020/10/07 09:59:47 [INFO] The key was stored by BCCSP provider 'SW'</span><br><span class="line">2020/10/07 09:59:47 [INFO] The certificate is at: /root/contract-deposit/ca.court.com/ca-cert.pem</span><br><span class="line">2020/10/07 09:59:47 [INFO] Initialized sqlite3 database at /root/contract-deposit/ca.court.com/fabric-ca-server.db</span><br><span class="line">2020/10/07 09:59:47 [INFO] The issuer key was successfully stored. The public key is at: /root/contract-deposit/ca.court.com/IssuerPublicKey, secret key is at: /root/contract-deposit/ca.court.com/msp/keystore/IssuerSecretKey</span><br><span class="line">2020/10/07 09:59:47 [INFO] Idemix issuer revocation public and secret keys were generated for CA ''</span><br><span class="line">2020/10/07 09:59:47 [INFO] The revocation key was successfully stored. The public key is at: /root/contract-deposit/ca.court.com/IssuerRevocationPublicKey, private key is at: /root/contract-deposit/ca.court.com/msp/keystore/IssuerRevocationPrivateKey</span><br><span class="line">2020/10/07 09:59:47 [INFO] Home directory for default CA: /root/contract-deposit/ca.court.com</span><br><span class="line">2020/10/07 09:59:47 [INFO] Initialization was successful</span><br><span class="line">[root@vm192168303 ca.court.com]# tree</span><br><span class="line">.</span><br><span class="line">├── ca-cert.pem</span><br><span class="line">├── ca-chain.pem</span><br><span class="line">├── ca.court.com-config.yaml</span><br><span class="line">├── fabric-ca-server.db</span><br><span class="line">├── IssuerPublicKey</span><br><span class="line">├── IssuerRevocationPublicKey</span><br><span class="line">└── msp</span><br><span class="line">    ├── cacerts</span><br><span class="line">    ├── keystore</span><br><span class="line">    │   ├── 4ddbac0604a9d0144195f041900959348ba5063b6fae16148aa30e96afc133e6_sk</span><br><span class="line">    │   ├── IssuerRevocationPrivateKey</span><br><span class="line">    │   └── IssuerSecretKey</span><br><span class="line">    ├── signcerts</span><br><span class="line">    └── user</span><br><span class="line"></span><br><span class="line">5 directories, 9 files</span><br><span class="line">[root@vm192168303 ca.court.com]#</span><br></pre></td></tr></table></figure>

<h3 id="（3）ca-court-com-yaml"><a href="#（3）ca-court-com-yaml" class="headerlink" title="（3）ca.court.com.yaml"></a>（3）ca.court.com.yaml</h3><blockquote>
<p>Fabric环境变量请参考：<a href="http://cw.hubwiz.com/card/c/fabric-env-manual/" target="_blank" rel="noopener">http://cw.hubwiz.com/card/c/fabric-env-manual/</a></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">version: '2'</span><br><span class="line">services:</span><br><span class="line">  ca.court.com:</span><br><span class="line">    container_name: ca.court.com</span><br><span class="line">    image: hyperledger/fabric-ca:1.4.3</span><br><span class="line">    environment:</span><br><span class="line">      - FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server</span><br><span class="line">      - FABRIC_CA_SERVER_CA_NAME=ca.court.com</span><br><span class="line">      - FABRIC_CA_SERVER_TLS_ENABLED=false</span><br><span class="line">    ports:</span><br><span class="line">      - "7054:7054"</span><br><span class="line">    command: sh -c 'fabric-ca-server start -c /etc/hyperledger/fabric-ca-server/ca.court.com-config.yaml --cfg.affiliations.allowremove --cfg.identities.allowremove -d'</span><br><span class="line">    volumes:</span><br><span class="line">      - ./ca.court.com/:/etc/hyperledger/fabric-ca-server</span><br><span class="line">    networks:</span><br><span class="line">      default:</span><br><span class="line">        aliases:</span><br><span class="line">          - contract-deposit</span><br></pre></td></tr></table></figure>

<h3 id="（4）启动ca-court-com"><a href="#（4）启动ca-court-com" class="headerlink" title="（4）启动ca.court.com"></a>（4）启动ca.court.com</h3><blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 启动容器</span></span><br><span class="line">docker-compose -f ca.court.com.yaml up -d</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看容器</span></span><br><span class="line">docker ps</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看日志</span></span><br><span class="line">docker logs ca.root.com</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@vm192168303 contract-deposit]# docker-compose -f ca.court.com.yaml up -d</span><br><span class="line">Starting ca.court.com ... done</span><br><span class="line">[root@vm192168303 contract-deposit]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE                         COMMAND                  CREATED             STATUS              PORTS                    NAMES</span><br><span class="line">53cc9d43221b        hyperledger/fabric-ca:1.4.3   "sh -c 'fabric-ca-se…"   2 minutes ago       Up 7 seconds        0.0.0.0:7054-&gt;7054/tcp   ca.court.com</span><br><span class="line">[root@vm192168303 contract-deposit]#</span><br></pre></td></tr></table></figure>

<h3 id="（5）登记注册"><a href="#（5）登记注册" class="headerlink" title="（5）登记注册"></a>（5）登记注册</h3><blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 引导账户</span></span><br><span class="line">export FABRIC_CA_CLIENT_HOME=./court-ca-admin</span><br><span class="line">fabric-ca-client enroll -u http://admin:adminpw@192.168.30.3:7054</span><br><span class="line"><span class="meta">#</span><span class="bash"> 注册 order0.court.com</span></span><br><span class="line">export FABRIC_CA_CLIENT_HOME=./court-ca-admin</span><br><span class="line">fabric-ca-client register --id.name order0.court.com --id.secret order0.court.com.pw --id.type orderer --id.affiliation court.department1</span><br><span class="line"><span class="meta">#</span><span class="bash"> 注册 order1.court.com</span></span><br><span class="line">export FABRIC_CA_CLIENT_HOME=./court-ca-admin</span><br><span class="line">fabric-ca-client register --id.name order1.court.com --id.secret order1.court.com.pw --id.type orderer --id.affiliation court.department1 </span><br><span class="line"><span class="meta">#</span><span class="bash"> 注册peer0.court.com</span></span><br><span class="line">export FABRIC_CA_CLIENT_HOME=./court-ca-admin</span><br><span class="line">fabric-ca-client register --id.name peer0.court.com --id.secret peer0.court.com.pw --id.type peer --id.affiliation court.department1</span><br><span class="line"><span class="meta">#</span><span class="bash"> 注册court-user</span></span><br><span class="line">export FABRIC_CA_CLIENT_HOME=./court-ca-admin</span><br><span class="line">fabric-ca-client register --id.name court-user --id.secret court-user.pw --id.type client --id.affiliation court.department1</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@vm192168303 contract-deposit]# export FABRIC_CA_CLIENT_HOME=./court-ca-admin</span><br><span class="line">[root@vm192168303 contract-deposit]# fabric-ca-client enroll -u http://admin:adminpw@192.168.30.3:7054</span><br><span class="line">2020/10/07 10:04:59 [INFO] generating key: &amp;&#123;A:ecdsa S:256&#125;</span><br><span class="line">2020/10/07 10:05:00 [INFO] encoded CSR</span><br><span class="line">2020/10/07 10:05:00 [INFO] Stored client certificate at /root/contract-deposit/court-ca-admin/AdminMSP/signcerts/cert.pem</span><br><span class="line">2020/10/07 10:05:00 [INFO] Stored root CA certificate at /root/contract-deposit/court-ca-admin/AdminMSP/cacerts/192-168-30-3-7054.pem</span><br><span class="line">2020/10/07 10:05:00 [INFO] Stored intermediate CA certificates at /root/contract-deposit/court-ca-admin/AdminMSP/intermediatecerts/192-168-30-3-7054.pem</span><br><span class="line">2020/10/07 10:05:00 [INFO] Stored Issuer public key at /root/contract-deposit/court-ca-admin/AdminMSP/IssuerPublicKey</span><br><span class="line">2020/10/07 10:05:00 [INFO] Stored Issuer revocation public key at /root/contract-deposit/court-ca-admin/AdminMSP/IssuerRevocationPublicKey</span><br><span class="line">[root@vm192168303 contract-deposit]# export FABRIC_CA_CLIENT_HOME=./court-ca-admin</span><br><span class="line">[root@vm192168303 contract-deposit]# fabric-ca-client register --id.name order0.court.com --id.secret order0.court.com.pw --id.type orderer --id.affiliation court.department1</span><br><span class="line">2020/10/07 10:05:11 [INFO] Configuration file location: /root/contract-deposit/court-ca-admin/fabric-ca-client-config.yaml</span><br><span class="line">Password: order0.court.com.pw</span><br><span class="line">[root@vm192168303 contract-deposit]# export FABRIC_CA_CLIENT_HOME=./court-ca-admin</span><br><span class="line">[root@vm192168303 contract-deposit]# fabric-ca-client register --id.name order1.court.com --id.secret order1.court.com.pw --id.type orderer --id.affiliation court.department1 </span><br><span class="line">2020/10/07 10:05:21 [INFO] Configuration file location: /root/contract-deposit/court-ca-admin/fabric-ca-client-config.yaml</span><br><span class="line">Password: order1.court.com.pw</span><br><span class="line">[root@vm192168303 contract-deposit]# export FABRIC_CA_CLIENT_HOME=./court-ca-admin</span><br><span class="line">[root@vm192168303 contract-deposit]# fabric-ca-client register --id.name peer0.court.com --id.secret peer0.court.com.pw --id.type peer --id.affiliation court.department1</span><br><span class="line">2020/10/07 10:05:31 [INFO] Configuration file location: /root/contract-deposit/court-ca-admin/fabric-ca-client-config.yaml</span><br><span class="line">Password: peer0.court.com.pw</span><br><span class="line">[root@vm192168303 contract-deposit]# export FABRIC_CA_CLIENT_HOME=./court-ca-admin</span><br><span class="line">[root@vm192168303 contract-deposit]# fabric-ca-client register --id.name court-user --id.secret court-user.pw --id.type client --id.affiliation court.department1</span><br><span class="line">2020/10/07 10:05:40 [INFO] Configuration file location: /root/contract-deposit/court-ca-admin/fabric-ca-client-config.yaml</span><br><span class="line">Password: court-user.pw</span><br><span class="line">[root@vm192168303 contract-deposit]#</span><br></pre></td></tr></table></figure>

<h2 id="4、ca-user-com（192-168-30-4）"><a href="#4、ca-user-com（192-168-30-4）" class="headerlink" title="4、ca.user.com（192.168.30.4）"></a>4、ca.user.com（192.168.30.4）</h2><h3 id="（1）ca-user-com-config-yaml"><a href="#（1）ca-user-com-config-yaml" class="headerlink" title="（1）ca.user.com-config.yaml"></a>（1）ca.user.com-config.yaml</h3><blockquote>
<p>路径：contract-deposit/ca.user.com/ca.user.com-config.yaml。</p>
<p>功能：配置ca.user.com。</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 版本</span></span><br><span class="line">version: 1.4.3</span><br><span class="line"><span class="meta">#</span><span class="bash"> 组织</span></span><br><span class="line">affiliations:</span><br><span class="line">   court:</span><br><span class="line">      - department1</span><br><span class="line">      - department2</span><br><span class="line"><span class="meta">#</span><span class="bash"> 签名请求</span></span><br><span class="line">csr:</span><br><span class="line">   cn:</span><br><span class="line">   keyrequest:</span><br><span class="line">     algo: ecdsa</span><br><span class="line">     size: 256</span><br><span class="line">   names:</span><br><span class="line">      - C: CN</span><br><span class="line">        ST: HeNan</span><br><span class="line">        L: ZhengZhou</span><br><span class="line">        O: Court</span><br><span class="line">        OU: CA</span><br><span class="line">   hosts:</span><br><span class="line">     - ca.court.com</span><br><span class="line">     - localhost</span><br><span class="line">   ca:</span><br><span class="line">      expiry: 131400h</span><br><span class="line">      pathlength: 0</span><br><span class="line"><span class="meta">#</span><span class="bash"> 中间ca</span></span><br><span class="line">intermediate:</span><br><span class="line">  parentserver:</span><br><span class="line">    url: ca.root.com:7054</span><br><span class="line">    caname: ca.root.com</span><br></pre></td></tr></table></figure>

<h3 id="（2）初始化-1"><a href="#（2）初始化-1" class="headerlink" title="（2）初始化"></a>（2）初始化</h3><blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 登记 + 初始化</span></span><br><span class="line">fabric-ca-server init \</span><br><span class="line">-b admin:adminpw \</span><br><span class="line">-u http://ca.user.com:ca.user.com.pw@192.168.30.2:7054 \</span><br><span class="line">-c ./ca.user.com-config.yaml</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">[root@vm192168304 contract-deposit]# cd ca.user.com/</span><br><span class="line">[root@vm192168304 ca.user.com]# ls</span><br><span class="line">ca.user.com-config.yaml</span><br><span class="line">[root@vm192168304 ca.user.com]# fabric-ca-server init \</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -b admin:adminpw \</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -u http://ca.user.com:ca.user.com.pw@192.168.30.2:7054 \</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -c ./ca.user.com-config.yaml</span></span><br><span class="line">2020/10/07 10:07:48 [INFO] Configuration file location: /root/contract-deposit/ca.user.com/ca.user.com-config.yaml</span><br><span class="line">2020/10/07 10:07:48 [INFO] Server Version: 1.4.6</span><br><span class="line">2020/10/07 10:07:48 [INFO] Server Levels: &amp;&#123;Identity:2 Affiliation:1 Certificate:1 Credential:1 RAInfo:1 Nonce:1&#125;</span><br><span class="line">2020/10/07 10:07:48 [WARNING] &amp;&#123;69 The specified CA certificate file /root/contract-deposit/ca.user.com/ca-cert.pem does not exist&#125;</span><br><span class="line">2020/10/07 10:07:48 [INFO] generating key: &amp;&#123;A:ecdsa S:256&#125;</span><br><span class="line">2020/10/07 10:07:48 [INFO] encoded CSR</span><br><span class="line">2020/10/07 10:07:48 [INFO] The CA key and certificate were generated for CA </span><br><span class="line">2020/10/07 10:07:48 [INFO] The key was stored by BCCSP provider 'SW'</span><br><span class="line">2020/10/07 10:07:48 [INFO] The certificate is at: /root/contract-deposit/ca.user.com/ca-cert.pem</span><br><span class="line">2020/10/07 10:07:48 [INFO] Initialized sqlite3 database at /root/contract-deposit/ca.user.com/fabric-ca-server.db</span><br><span class="line">2020/10/07 10:07:48 [INFO] The issuer key was successfully stored. The public key is at: /root/contract-deposit/ca.user.com/IssuerPublicKey, secret key is at: /root/contract-deposit/ca.user.com/msp/keystore/IssuerSecretKey</span><br><span class="line">2020/10/07 10:07:48 [INFO] Idemix issuer revocation public and secret keys were generated for CA ''</span><br><span class="line">2020/10/07 10:07:48 [INFO] The revocation key was successfully stored. The public key is at: /root/contract-deposit/ca.user.com/IssuerRevocationPublicKey, private key is at: /root/contract-deposit/ca.user.com/msp/keystore/IssuerRevocationPrivateKey</span><br><span class="line">2020/10/07 10:07:48 [INFO] Home directory for default CA: /root/contract-deposit/ca.user.com</span><br><span class="line">2020/10/07 10:07:48 [INFO] Initialization was successful</span><br><span class="line">[root@vm192168304 ca.user.com]# tree</span><br><span class="line">.</span><br><span class="line">├── ca-cert.pem</span><br><span class="line">├── ca-chain.pem</span><br><span class="line">├── ca.user.com-config.yaml</span><br><span class="line">├── fabric-ca-server.db</span><br><span class="line">├── IssuerPublicKey</span><br><span class="line">├── IssuerRevocationPublicKey</span><br><span class="line">└── msp</span><br><span class="line">    ├── cacerts</span><br><span class="line">    ├── keystore</span><br><span class="line">    │   ├── c835ed10e83ebca161238e043c588ce4273d66b86e7a0352f02d1501e11ee4f0_sk</span><br><span class="line">    │   ├── IssuerRevocationPrivateKey</span><br><span class="line">    │   └── IssuerSecretKey</span><br><span class="line">    ├── signcerts</span><br><span class="line">    └── user</span><br><span class="line"></span><br><span class="line">5 directories, 9 files</span><br><span class="line">[root@vm192168304 ca.user.com]#</span><br></pre></td></tr></table></figure>

<h3 id="（3）ca-user-com-yaml"><a href="#（3）ca-user-com-yaml" class="headerlink" title="（3）ca.user.com.yaml"></a>（3）ca.user.com.yaml</h3><blockquote>
<p>Fabric环境变量请参考：<a href="http://cw.hubwiz.com/card/c/fabric-env-manual/" target="_blank" rel="noopener">http://cw.hubwiz.com/card/c/fabric-env-manual/</a></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">version: '2'</span><br><span class="line">services:</span><br><span class="line">  ca.user.com:</span><br><span class="line">    container_name: ca.user.com</span><br><span class="line">    image: hyperledger/fabric-ca:1.4.3</span><br><span class="line">    environment:</span><br><span class="line">      - FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server</span><br><span class="line">      - FABRIC_CA_SERVER_CA_NAME=ca.user.com</span><br><span class="line">      - FABRIC_CA_SERVER_TLS_ENABLED=false</span><br><span class="line">    ports:</span><br><span class="line">      - "7054:7054"</span><br><span class="line">    command: sh -c 'fabric-ca-server start -c /etc/hyperledger/fabric-ca-server/ca.user.com-config.yaml -d'</span><br><span class="line">    volumes:</span><br><span class="line">      - ./ca.user.com/:/etc/hyperledger/fabric-ca-server</span><br></pre></td></tr></table></figure>

<h3 id="（4）启动ca-user-com"><a href="#（4）启动ca-user-com" class="headerlink" title="（4）启动ca.user.com"></a>（4）启动ca.user.com</h3><blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> docker-compose按ca.user.com.yaml启动容器</span></span><br><span class="line">docker-compose -f ca.user.com.yaml up -d</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查询正在工作的容器</span></span><br><span class="line">docker ps</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看日志</span></span><br><span class="line">docker logs ca.user.com</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@vm192168304 contract-deposit]# docker-compose -f ca.user.com.yaml up -d</span><br><span class="line">Creating network "contract-deposit_default" with the default driver</span><br><span class="line">Creating ca.user.com ... done</span><br><span class="line">[root@vm192168304 contract-deposit]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE                         COMMAND                  CREATED             STATUS              PORTS                    NAMES</span><br><span class="line">34ddb65cc762        hyperledger/fabric-ca:1.4.3   "sh -c 'fabric-ca-se…"   5 seconds ago       Up 4 seconds        0.0.0.0:7054-&gt;7054/tcp   ca.user.com</span><br><span class="line">[root@vm192168304 contract-deposit]#</span><br></pre></td></tr></table></figure>

<h3 id="（5）登记注册-1"><a href="#（5）登记注册-1" class="headerlink" title="（5）登记注册"></a>（5）登记注册</h3><blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 引导账户</span></span><br><span class="line">export FABRIC_CA_CLIENT_HOME=./user-ca-admin</span><br><span class="line">fabric-ca-client enroll -u http://admin:adminpw@192.168.30.4:7054</span><br><span class="line"><span class="meta">#</span><span class="bash"> 注册 order.user.com</span></span><br><span class="line">export FABRIC_CA_CLIENT_HOME=./user-ca-admin</span><br><span class="line">fabric-ca-client register --id.name order.user.com --id.secret order.user.com.pw --id.type orderer --id.affiliation user.department1</span><br><span class="line"><span class="meta">#</span><span class="bash"> 注册 peer0.user.com</span></span><br><span class="line">export FABRIC_CA_CLIENT_HOME=./user-ca-admin</span><br><span class="line">fabric-ca-client register --id.name peer0.user.com --id.secret peer0.user.com.pw --id.type peer --id.affiliation user.department1</span><br><span class="line"><span class="meta">#</span><span class="bash"> 注册 user-user</span></span><br><span class="line">export FABRIC_CA_CLIENT_HOME=./user-ca-admin</span><br><span class="line">fabric-ca-client register --id.name user-user --id.secret user-user.pw --id.type client --id.affiliation user.department1</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@vm192168304 contract-deposit]# export FABRIC_CA_CLIENT_HOME=./user-ca-admin</span><br><span class="line">[root@vm192168304 contract-deposit]# fabric-ca-client enroll -u http://admin:adminpw@192.168.30.4:7054</span><br><span class="line">2020/10/07 10:08:51 [INFO] generating key: &amp;&#123;A:ecdsa S:256&#125;</span><br><span class="line">2020/10/07 10:08:51 [INFO] encoded CSR</span><br><span class="line">2020/10/07 10:08:51 [INFO] Stored client certificate at /root/contract-deposit/user-ca-admin/AdminMSP/signcerts/cert.pem</span><br><span class="line">2020/10/07 10:08:51 [INFO] Stored root CA certificate at /root/contract-deposit/user-ca-admin/AdminMSP/cacerts/192-168-30-4-7054.pem</span><br><span class="line">2020/10/07 10:08:51 [INFO] Stored intermediate CA certificates at /root/contract-deposit/user-ca-admin/AdminMSP/intermediatecerts/192-168-30-4-7054.pem</span><br><span class="line">2020/10/07 10:08:51 [INFO] Stored Issuer public key at /root/contract-deposit/user-ca-admin/AdminMSP/IssuerPublicKey</span><br><span class="line">2020/10/07 10:08:51 [INFO] Stored Issuer revocation public key at /root/contract-deposit/user-ca-admin/AdminMSP/IssuerRevocationPublicKey</span><br><span class="line">[root@vm192168304 contract-deposit]# export FABRIC_CA_CLIENT_HOME=./user-ca-admin</span><br><span class="line">[root@vm192168304 contract-deposit]# fabric-ca-client register --id.name order.user.com --id.secret order.user.com.pw --id.type orderer --id.affiliation user.department1</span><br><span class="line">2020/10/07 10:08:58 [INFO] Configuration file location: /root/contract-deposit/user-ca-admin/fabric-ca-client-config.yaml</span><br><span class="line">Password: order.user.com.pw</span><br><span class="line">[root@vm192168304 contract-deposit]# export FABRIC_CA_CLIENT_HOME=./user-ca-admin</span><br><span class="line">[root@vm192168304 contract-deposit]# fabric-ca-client register --id.name peer0.user.com --id.secret peer0.user.com.pw --id.type peer --id.affiliation user.department1</span><br><span class="line">2020/10/07 10:09:07 [INFO] Configuration file location: /root/contract-deposit/user-ca-admin/fabric-ca-client-config.yaml</span><br><span class="line">Password: peer0.user.com.pw</span><br><span class="line">[root@vm192168304 contract-deposit]# export FABRIC_CA_CLIENT_HOME=./user-ca-admin</span><br><span class="line">[root@vm192168304 contract-deposit]# fabric-ca-client register --id.name user-user --id.secret user-user.pw --id.type client --id.affiliation user.department1</span><br><span class="line">2020/10/07 10:09:14 [INFO] Configuration file location: /root/contract-deposit/user-ca-admin/fabric-ca-client-config.yaml</span><br><span class="line">Password: user-user.pw</span><br><span class="line">[root@vm192168304 contract-deposit]#</span><br></pre></td></tr></table></figure>

<h2 id="5、证书组织"><a href="#5、证书组织" class="headerlink" title="5、证书组织"></a>5、证书组织</h2><blockquote>
<p>有两种方法：</p>
<p>1、所有证书，在需要使用这些证书的节点上进行登记；管理员证书组织在一起初始化网络（创世区块、通道文件、锚节点文件）。</p>
<p>2、所有证书在一台机器上进行登记；管理员证书组织在一起初始化网络（创世区块、通道文件、锚节点文件）。</p>
<p>毫无疑问把所有证书都在一个地方进行登记是最省事的办法。</p>
<p>优点如下：</p>
<p>1、下边的网络搭建过程还不知道会出现什么问题；这样可以在三个ca不动的前提下随便折腾网络搭建部分。</p>
<p>2、简化文件组织；或者说这样文件组织更容易操作。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@vm192168305 contract-deposit]# tree</span><br><span class="line">.</span><br><span class="line">├── 192.168.30.2</span><br><span class="line">│   ├── ca.root.com</span><br><span class="line">│   │   ├── ca.root.com-config.yaml</span><br><span class="line">│   │   └── msp</span><br><span class="line">│   │       ├── ca.cert.pem</span><br><span class="line">│   │       └── ca.key.pem</span><br><span class="line">│   ├── ca.root.com.yaml</span><br><span class="line">│   └── root-ca-admin</span><br><span class="line">│       └── fabric-ca-client-config.yaml</span><br><span class="line">├── 192.168.30.3</span><br><span class="line">│   ├── ca.court.com</span><br><span class="line">│   │   └── ca.court.com-config.yaml</span><br><span class="line">│   ├── ca.court.com.yaml</span><br><span class="line">│   └── court-ca-admin</span><br><span class="line">│       └── fabric-ca-client-config.yaml</span><br><span class="line">└── 192.168.30.4</span><br><span class="line">    ├── ca.user.com</span><br><span class="line">    │   └── ca.user.com-config.yaml</span><br><span class="line">    ├── ca.user.com.yaml</span><br><span class="line">    └── user-ca-admin</span><br><span class="line">        └── fabric-ca-client-config.yaml</span><br><span class="line"></span><br><span class="line">10 directories, 11 files</span><br><span class="line">[root@vm192168305 contract-deposit]# </span><br></pre></td></tr></table></figure>

<blockquote>
<p>每个证书的登记都要一个fabric-ca-client-config.yaml来说明要求ca给颁发什么样的证书。</p>
<p>三个ca的引导用户的配置文件都有点烦了何况7个。</p>
<p>引导用户可以不进行配置因为他唯一的作用是进行注册，证书颁发颁成默认的影响不大，所以在上面没有进行描述。</p>
</blockquote>
</blockquote>
<h3 id="（1）登记配置文件编写"><a href="#（1）登记配置文件编写" class="headerlink" title="（1）登记配置文件编写"></a>（1）登记配置文件编写</h3><h3 id="（2）登记"><a href="#（2）登记" class="headerlink" title="（2）登记"></a>（2）登记</h3><blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#######################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">##########################court</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#######################################################################</span></span></span><br><span class="line">fabric-ca-client enroll \</span><br><span class="line">-u http://order0.court.com:order0.court.com.pw@192.168.30.3:7054 \</span><br><span class="line">-c order0.court.com-config.yaml </span><br><span class="line">fabric-ca-client enroll \</span><br><span class="line">-u http://order1.court.com:order1.court.com.pw@192.168.30.3:7054 \</span><br><span class="line">-c order1.court.com-config.yaml </span><br><span class="line">fabric-ca-client enroll \</span><br><span class="line">-u http://peer0.court.com:peer0.court.com.pw@192.168.30.3:7054 \</span><br><span class="line">-c peer0.court.com-config.yaml </span><br><span class="line">fabric-ca-client enroll \</span><br><span class="line">-u http://court-user:court-user.pw@192.168.30.3:7054 \</span><br><span class="line">-c court-user-config.yaml </span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#######################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">##########################user</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#######################################################################</span></span></span><br><span class="line">fabric-ca-client enroll \</span><br><span class="line">-u http://order.user.com:order.user.com.pw@192.168.30.4:7054 \</span><br><span class="line">-c order.user.com-config.yaml </span><br><span class="line">fabric-ca-client enroll \</span><br><span class="line">-u http://peer0.user.com:peer0.user.com.pw@192.168.30.4:7054 \</span><br><span class="line">-c peer0.user.com-config.yaml </span><br><span class="line">fabric-ca-client enroll \</span><br><span class="line">-u http://user-user:user-user.pw@192.168.30.4:7054 \</span><br><span class="line">-c user-user-config.yaml </span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">[root@vm192168305 crypto]# fabric-ca-client enroll \</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -u http://order0.court.com:order0.court.com.pw@192.168.30.3:7054 \</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -c order0.court.com-config.yaml </span></span><br><span class="line">ic-ca-client enroll \</span><br><span class="line">-u http://peer0.court.com:peer0.court.com.pw@192.168.30.3:7054 \</span><br><span class="line">-c peer0.court.com-config.yaml </span><br><span class="line">fabric-ca-client enroll \</span><br><span class="line">-u http://court-user:court-user.pw@192.168.30.3:7054 \</span><br><span class="line">-c court-user-config.yaml 2020/10/07 11:23:17 [INFO] generating key: &amp;&#123;A:ecdsa S:256&#125;</span><br><span class="line">2020/10/07 11:23:17 [INFO] encoded CSR</span><br><span class="line">2020/10/07 11:23:17 [INFO] Stored client certificate at /root/contract-deposit/crypto/crypto/court/order0.court.com/signcerts/cert.pem</span><br><span class="line">2020/10/07 11:23:17 [INFO] Stored root CA certificate at /root/contract-deposit/crypto/crypto/court/order0.court.com/cacerts/192-168-30-3-7054.pem</span><br><span class="line">2020/10/07 11:23:17 [INFO] Stored intermediate CA certificates at /root/contract-deposit/crypto/crypto/court/order0.court.com/intermediatecerts/192-168-30-3-7054.pem</span><br><span class="line">2020/10/07 11:23:17 [INFO] Stored Issuer public key at /root/contract-deposit/crypto/crypto/court/order0.court.com/IssuerPublicKey</span><br><span class="line">2020/10/07 11:23:17 [INFO] Stored Issuer revocation public key at /root/contract-deposit/crypto/crypto/court/order0.court.com/IssuerRevocationPublicKey</span><br><span class="line">[root@vm192168305 crypto]# fabric-ca-client enroll \</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -u http://order1.court.com:order1.court.com.pw@192.168.30.3:7054 \</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -c order1.court.com-config.yaml </span></span><br><span class="line">2020/10/07 11:23:17 [INFO] generating key: &amp;&#123;A:ecdsa S:256&#125;</span><br><span class="line">2020/10/07 11:23:17 [INFO] encoded CSR</span><br><span class="line">2020/10/07 11:23:18 [INFO] Stored client certificate at /root/contract-deposit/crypto/crypto/court/order1.court.com/signcerts/cert.pem</span><br><span class="line">2020/10/07 11:23:18 [INFO] Stored root CA certificate at /root/contract-deposit/crypto/crypto/court/order1.court.com/cacerts/192-168-30-3-7054.pem</span><br><span class="line">2020/10/07 11:23:18 [INFO] Stored intermediate CA certificates at /root/contract-deposit/crypto/crypto/court/order1.court.com/intermediatecerts/192-168-30-3-7054.pem</span><br><span class="line">2020/10/07 11:23:18 [INFO] Stored Issuer public key at /root/contract-deposit/crypto/crypto/court/order1.court.com/IssuerPublicKey</span><br><span class="line">2020/10/07 11:23:18 [INFO] Stored Issuer revocation public key at /root/contract-deposit/crypto/crypto/court/order1.court.com/IssuerRevocationPublicKey</span><br><span class="line">[root@vm192168305 crypto]# fabric-ca-client enroll \</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -u http://peer0.court.com:peer0.court.com.pw@192.168.30.3:7054 \</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -c peer0.court.com-config.yaml </span></span><br><span class="line">2020/10/07 11:23:18 [INFO] generating key: &amp;&#123;A:ecdsa S:256&#125;</span><br><span class="line">2020/10/07 11:23:18 [INFO] encoded CSR</span><br><span class="line">2020/10/07 11:23:18 [INFO] Stored client certificate at /root/contract-deposit/crypto/crypto/court/peer0.court.com/signcerts/cert.pem</span><br><span class="line">2020/10/07 11:23:18 [INFO] Stored root CA certificate at /root/contract-deposit/crypto/crypto/court/peer0.court.com/cacerts/192-168-30-3-7054.pem</span><br><span class="line">2020/10/07 11:23:18 [INFO] Stored intermediate CA certificates at /root/contract-deposit/crypto/crypto/court/peer0.court.com/intermediatecerts/192-168-30-3-7054.pem</span><br><span class="line">2020/10/07 11:23:18 [INFO] Stored Issuer public key at /root/contract-deposit/crypto/crypto/court/peer0.court.com/IssuerPublicKey</span><br><span class="line">2020/10/07 11:23:18 [INFO] Stored Issuer revocation public key at /root/contract-deposit/crypto/crypto/court/peer0.court.com/IssuerRevocationPublicKey</span><br><span class="line">[root@vm192168305 crypto]# fabric-ca-client enroll \</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -u http://court-user:court-user.pw@192.168.30.3:7054 \</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -c court-user-config.yaml </span></span><br><span class="line">2020/10/07 11:23:18 [INFO] generating key: &amp;&#123;A:ecdsa S:256&#125;</span><br><span class="line">2020/10/07 11:23:18 [INFO] encoded CSR</span><br><span class="line">2020/10/07 11:23:18 [INFO] Stored client certificate at /root/contract-deposit/crypto/crypto/court/court-user/signcerts/cert.pem</span><br><span class="line">2020/10/07 11:23:18 [INFO] Stored root CA certificate at /root/contract-deposit/crypto/crypto/court/court-user/cacerts/192-168-30-3-7054.pem</span><br><span class="line">2020/10/07 11:23:18 [INFO] Stored intermediate CA certificates at /root/contract-deposit/crypto/crypto/court/court-user/intermediatecerts/192-168-30-3-7054.pem</span><br><span class="line">2020/10/07 11:23:18 [INFO] Stored Issuer public key at /root/contract-deposit/crypto/crypto/court/court-user/IssuerPublicKey</span><br><span class="line">2020/10/07 11:23:18 [INFO] Stored Issuer revocation public key at /root/contract-deposit/crypto/crypto/court/court-user/IssuerRevocationPublicKey</span><br><span class="line">[root@vm192168305 crypto]# fabric-ca-client enroll \</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -u http://order.user.com:order.user.com.pw@192.168.30.4:7054 \</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -c order.user.com-config.yaml </span></span><br><span class="line"> enroll \</span><br><span class="line">-u http://user-user:user-user.pw@192.168.30.4:7054 \</span><br><span class="line">-c user-user-config.yaml 2020/10/07 11:23:28 [INFO] generating key: &amp;&#123;A:ecdsa S:256&#125;</span><br><span class="line">2020/10/07 11:23:28 [INFO] encoded CSR</span><br><span class="line">2020/10/07 11:23:28 [INFO] Stored client certificate at /root/contract-deposit/crypto/crypto/user/order.user.com/signcerts/cert.pem</span><br><span class="line">2020/10/07 11:23:28 [INFO] Stored root CA certificate at /root/contract-deposit/crypto/crypto/user/order.user.com/cacerts/192-168-30-4-7054.pem</span><br><span class="line">2020/10/07 11:23:28 [INFO] Stored intermediate CA certificates at /root/contract-deposit/crypto/crypto/user/order.user.com/intermediatecerts/192-168-30-4-7054.pem</span><br><span class="line">2020/10/07 11:23:28 [INFO] Stored Issuer public key at /root/contract-deposit/crypto/crypto/user/order.user.com/IssuerPublicKey</span><br><span class="line">2020/10/07 11:23:28 [INFO] Stored Issuer revocation public key at /root/contract-deposit/crypto/crypto/user/order.user.com/IssuerRevocationPublicKey</span><br><span class="line">[root@vm192168305 crypto]# fabric-ca-client enroll \</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -u http://peer0.user.com:peer0.user.com.pw@192.168.30.4:7054 \</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -c peer0.user.com-config.yaml </span></span><br><span class="line">2020/10/07 11:23:28 [INFO] generating key: &amp;&#123;A:ecdsa S:256&#125;</span><br><span class="line">2020/10/07 11:23:28 [INFO] encoded CSR</span><br><span class="line">2020/10/07 11:23:28 [INFO] Stored client certificate at /root/contract-deposit/crypto/crypto/user/peer0.user.com/signcerts/cert.pem</span><br><span class="line">2020/10/07 11:23:28 [INFO] Stored root CA certificate at /root/contract-deposit/crypto/crypto/user/peer0.user.com/cacerts/192-168-30-4-7054.pem</span><br><span class="line">2020/10/07 11:23:28 [INFO] Stored intermediate CA certificates at /root/contract-deposit/crypto/crypto/user/peer0.user.com/intermediatecerts/192-168-30-4-7054.pem</span><br><span class="line">2020/10/07 11:23:28 [INFO] Stored Issuer public key at /root/contract-deposit/crypto/crypto/user/peer0.user.com/IssuerPublicKey</span><br><span class="line">2020/10/07 11:23:28 [INFO] Stored Issuer revocation public key at /root/contract-deposit/crypto/crypto/user/peer0.user.com/IssuerRevocationPublicKey</span><br><span class="line">[root@vm192168305 crypto]# fabric-ca-client enroll \</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -u http://user-user:user-user.pw@192.168.30.4:7054 \</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> -c user-user-config.yaml </span></span><br><span class="line">2020/10/07 11:23:29 [INFO] generating key: &amp;&#123;A:ecdsa S:256&#125;</span><br><span class="line">2020/10/07 11:23:29 [INFO] encoded CSR</span><br><span class="line">2020/10/07 11:23:29 [INFO] Stored client certificate at /root/contract-deposit/crypto/crypto/user/user-user/signcerts/cert.pem</span><br><span class="line">2020/10/07 11:23:29 [INFO] Stored root CA certificate at /root/contract-deposit/crypto/crypto/user/user-user/cacerts/192-168-30-4-7054.pem</span><br><span class="line">2020/10/07 11:23:29 [INFO] Stored intermediate CA certificates at /root/contract-deposit/crypto/crypto/user/user-user/intermediatecerts/192-168-30-4-7054.pem</span><br><span class="line">2020/10/07 11:23:29 [INFO] Stored Issuer public key at /root/contract-deposit/crypto/crypto/user/user-user/IssuerPublicKey</span><br><span class="line">2020/10/07 11:23:29 [INFO] Stored Issuer revocation public key at /root/contract-deposit/crypto/crypto/user/user-user/IssuerRevocationPublicKey</span><br><span class="line">[root@vm192168305 crypto]# tree -L 3</span><br><span class="line">.</span><br><span class="line">├── court-user-config.yaml</span><br><span class="line">├── crypto</span><br><span class="line">│   ├── court</span><br><span class="line">│   │   ├── court-user</span><br><span class="line">│   │   ├── order0.court.com</span><br><span class="line">│   │   ├── order1.court.com</span><br><span class="line">│   │   └── peer0.court.com</span><br><span class="line">│   └── user</span><br><span class="line">│       ├── order.user.com</span><br><span class="line">│       ├── peer0.user.com</span><br><span class="line">│       └── user-user</span><br><span class="line">├── order0.court.com-config.yaml</span><br><span class="line">├── order1.court.com-config.yaml</span><br><span class="line">├── order.user.com-config.yaml</span><br><span class="line">├── peer0.court.com-config.yaml</span><br><span class="line">├── peer0.user.com-config.yaml</span><br><span class="line">└── user-user-config.yaml</span><br><span class="line"></span><br><span class="line">10 directories, 7 files</span><br><span class="line">[root@vm192168305 crypto]# cd crypto/court/court-user/</span><br><span class="line">[root@vm192168305 court-user]# tree</span><br><span class="line">.</span><br><span class="line">├── cacerts</span><br><span class="line">│   └── 192-168-30-3-7054.pem</span><br><span class="line">├── intermediatecerts</span><br><span class="line">│   └── 192-168-30-3-7054.pem</span><br><span class="line">├── IssuerPublicKey</span><br><span class="line">├── IssuerRevocationPublicKey</span><br><span class="line">├── keystore</span><br><span class="line">│   └── 51fe103b7f19fe17e9ab3c60fbd84955f4d8b1468d34ff903c69bed4858c488c_sk</span><br><span class="line">├── signcerts</span><br><span class="line">│   └── cert.pem</span><br><span class="line">└── user</span><br><span class="line"></span><br><span class="line">5 directories, 6 files</span><br><span class="line">[root@vm192168305 court-user]#</span><br></pre></td></tr></table></figure>



<h1 id="（五）常用命令"><a href="#（五）常用命令" class="headerlink" title="（五）常用命令"></a>（五）常用命令</h1><blockquote>
<h2 id="删除用户"><a href="#删除用户" class="headerlink" title="删除用户"></a>删除用户</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fabric-ca-client identity remove ca.court.com</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<h2 id="证书链"><a href="#证书链" class="headerlink" title="证书链"></a>证书链</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fabric-ca-client getcainfo -u http://192.168.30.2:7054</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<h2 id="清空所有容器"><a href="#清空所有容器" class="headerlink" title="清空所有容器"></a>清空所有容器</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo docker stop $(docker ps -a -q)</span><br><span class="line">sudo docker ps -qa|xargs docker rm</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<h2 id="清空所有镜像"><a href="#清空所有镜像" class="headerlink" title="清空所有镜像"></a>清空所有镜像</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker image rm $(docker images -a -q)</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<h2 id="清理挂载卷"><a href="#清理挂载卷" class="headerlink" title="清理挂载卷"></a>清理挂载卷</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /var/lib/docker/volumes</span><br><span class="line">rm -rf ./*</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<h2 id="清理项目文件"><a href="#清理项目文件" class="headerlink" title="清理项目文件"></a>清理项目文件</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">rm -rf raft</span><br><span class="line">rm -rf /root/.local/share/Trash/files</span><br></pre></td></tr></table></figure>
</blockquote>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2020-10-07T03:27:49.203Z" itemprop="dateUpdated">2020-10-07 11:27:49</time>
</span><br>


        
    </div>
    
    <footer>
        <a href="http://cupswen.github.io">
            <img src="/img/the_Huanghe_River.png" alt="CupsWen">
            CupsWen
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Fabric/" rel="tag">Fabric</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://cupswen.github.io/2020/10/05/2020/contract-deposit/&title=《合同存证》 — Cups&pic=http://cupswen.github.io/img/the_Huanghe_River.png" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://cupswen.github.io/2020/10/05/2020/contract-deposit/&title=《合同存证》 — Cups&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://cupswen.github.io/2020/10/05/2020/contract-deposit/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《合同存证》 — Cups&url=http://cupswen.github.io/2020/10/05/2020/contract-deposit/&via=http://cupswen.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://cupswen.github.io/2020/10/05/2020/contract-deposit/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between flex-row-reverse">
  

  
    <div class="waves-block waves-effect next">
      <a href="/2020/10/03/2020/knowledge-point-1/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">一些知识点</h4>
      </a>
    </div>
  
</nav>



    

</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
            <span>This blog is licensed under a <a rel="license noopener" href="https://creativecommons.org/licenses/by/4.0/" target="_blank">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>CupsWen &copy; 2019 - 2020</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme indigo.</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://cupswen.github.io/2020/10/05/2020/contract-deposit/&title=《合同存证》 — Cups&pic=http://cupswen.github.io/img/the_Huanghe_River.png" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://cupswen.github.io/2020/10/05/2020/contract-deposit/&title=《合同存证》 — Cups&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://cupswen.github.io/2020/10/05/2020/contract-deposit/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《合同存证》 — Cups&url=http://cupswen.github.io/2020/10/05/2020/contract-deposit/&via=http://cupswen.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://cupswen.github.io/2020/10/05/2020/contract-deposit/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=http://cupswen.github.io/2020/10/05/2020/contract-deposit/" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = 'Cups';
            clearTimeout(titleTime);
        } else {
            document.title = 'Cups';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
