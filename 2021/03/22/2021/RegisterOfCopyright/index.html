<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>2021/RegisterOfCopyright | Cups</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="">
    <meta name="description" content="layout: postdate: 2021-3-22 21:43:10title: 版权登记(Fabric1.4.3)comments: falsereward: falsecategory: Fabrictags: [Fabric,Raft] 组织、域名、ip匹配表   域名 ip地址 组织 内网ip    orderer0.example.com 192.168.30.2 orderer 1">
<meta name="keywords" content="Be strict with yourself at all times.">
<meta property="og:type" content="article">
<meta property="og:title" content="2021&#x2F;RegisterOfCopyright">
<meta property="og:url" content="http:&#x2F;&#x2F;cupswen.github.io&#x2F;2021&#x2F;03&#x2F;22&#x2F;2021&#x2F;RegisterOfCopyright&#x2F;index.html">
<meta property="og:site_name" content="Cups">
<meta property="og:description" content="layout: postdate: 2021-3-22 21:43:10title: 版权登记(Fabric1.4.3)comments: falsereward: falsecategory: Fabrictags: [Fabric,Raft] 组织、域名、ip匹配表   域名 ip地址 组织 内网ip    orderer0.example.com 192.168.30.2 orderer 1">
<meta property="og:locale" content="en">
<meta property="og:image" content="http:&#x2F;&#x2F;cupswen.github.io&#x2F;img&#x2F;raft&#x2F;map.png">
<meta property="og:image" content="http:&#x2F;&#x2F;cupswen.github.io&#x2F;img&#x2F;raft&#x2F;ip.png">
<meta property="og:updated_time" content="2021-10-03T10:23:29.610Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http:&#x2F;&#x2F;cupswen.github.io&#x2F;img&#x2F;raft&#x2F;map.png">
    
    <link rel="shortcut icon" href="/img/brand.jpg">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/the_Huanghe_River.png">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">CupsWen</h5>
          <a href="mailto:1191567189@qq.com" target="_blank" rel="noopener" title="1191567189@qq.com" class="mail">1191567189@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/index.html"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/CupsWen" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://cupswen.github.io/hyperlink"  >
                <i class="icon icon-lg icon-link"></i>
                Link
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">2021/RegisterOfCopyright</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">2021/RegisterOfCopyright</h1>
        <h5 class="subtitle">
            
                <time datetime="2021-03-22T12:24:46.252Z" itemprop="datePublished" class="page-time">
  2021-03-22
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#组织、域名、ip匹配表"><span class="post-toc-text">组织、域名、ip匹配表</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#网络拓扑"><span class="post-toc-text">网络拓扑</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#配置这些虚拟机"><span class="post-toc-text">配置这些虚拟机</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#（一）虚拟机基础环境配置"><span class="post-toc-text">（一）虚拟机基础环境配置</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1、Xshell登录"><span class="post-toc-text">1、Xshell登录</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2、使虚拟机可以上网"><span class="post-toc-text">2、使虚拟机可以上网</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3、防火墙"><span class="post-toc-text">3、防火墙</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4、设置Selinux"><span class="post-toc-text">4、设置Selinux</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5、设置时间同步"><span class="post-toc-text">5、设置时间同步</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#6、安装常用工具"><span class="post-toc-text">6、安装常用工具</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#7、更换软件源"><span class="post-toc-text">7、更换软件源</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#8、更改hosts文件"><span class="post-toc-text">8、更改hosts文件</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Fabric相关操作"><span class="post-toc-text">Fabric相关操作</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#（一）准备相关文件"><span class="post-toc-text">（一）准备相关文件</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1、crypto-config-yaml"><span class="post-toc-text">1、crypto-config.yaml</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2、configtx-yaml"><span class="post-toc-text">2、configtx.yaml</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3、生成公私钥和证书"><span class="post-toc-text">3、生成公私钥和证书</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4、生成创世区块"><span class="post-toc-text">4、生成创世区块</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5、生成通道配置区块"><span class="post-toc-text">5、生成通道配置区块</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5、更新锚节点"><span class="post-toc-text">5、更新锚节点</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#6、复制文件"><span class="post-toc-text">6、复制文件</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#（二）启动网络"><span class="post-toc-text">（二）启动网络</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1、启动orderer节点"><span class="post-toc-text">1、启动orderer节点</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2、启动peer节点"><span class="post-toc-text">2、启动peer节点</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3、将peer节点加入通道"><span class="post-toc-text">3、将peer节点加入通道</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（1）DDC-192-168-30-14"><span class="post-toc-text">（1）DDC-192.168.30.14</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（2）OWP-192-168-30-15"><span class="post-toc-text">（2）OWP-192.168.30.15</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（3）LEO-192-168-30-16"><span class="post-toc-text">（3）LEO-192.168.30.16</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4、更新锚节点"><span class="post-toc-text">4、更新锚节点</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#（三）链码"><span class="post-toc-text">（三）链码</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1、安装链码"><span class="post-toc-text">1、安装链码</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（1）DDC-192-168-30-14-1"><span class="post-toc-text">（1）DDC-192.168.30.14</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（2）OWP-192-168-30-15-1"><span class="post-toc-text">（2）OWP-192.168.30.15</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#（3）LEO-192-168-30-16-1"><span class="post-toc-text">（3）LEO-192.168.30.16</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2、测试链码"><span class="post-toc-text">2、测试链码</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#常用命令"><span class="post-toc-text">常用命令</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#清空所有容器"><span class="post-toc-text">清空所有容器</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#清空所有镜像"><span class="post-toc-text">清空所有镜像</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#清理挂载卷"><span class="post-toc-text">清理挂载卷</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#清理项目文件"><span class="post-toc-text">清理项目文件</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-2021/RegisterOfCopyright"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">2021/RegisterOfCopyright</h1>
        <div class="post-meta">
            <time class="post-time" title="2021-03-22 20:24:46" datetime="2021-03-22T12:24:46.252Z"  itemprop="datePublished">2021-03-22</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p>layout: post<br>date: 2021-3-22 21:43:10<br>title: 版权登记(Fabric1.4.3)<br>comments: false<br>reward: false<br>category: Fabric<br>tags: [Fabric,Raft]</p>
<h1 id="组织、域名、ip匹配表"><a href="#组织、域名、ip匹配表" class="headerlink" title="组织、域名、ip匹配表"></a>组织、域名、ip匹配表</h1><table>
<thead>
<tr>
<th align="left">域名</th>
<th>ip地址</th>
<th align="center">组织</th>
<th align="center">内网ip</th>
</tr>
</thead>
<tbody><tr>
<td align="left">orderer0.example.com</td>
<td>192.168.30.2</td>
<td align="center">orderer</td>
<td align="center">123</td>
</tr>
<tr>
<td align="left">orderer1.example.com</td>
<td>192.168.30.3</td>
<td align="center">orderer</td>
<td align="center">123</td>
</tr>
<tr>
<td align="left">orderer2.example.com</td>
<td>192.168.30.4</td>
<td align="center">orderer</td>
<td align="center">123</td>
</tr>
<tr>
<td align="left">peer0.org1.example.com</td>
<td>192.168.30.5</td>
<td align="center">org1</td>
<td align="center">123</td>
</tr>
<tr>
<td align="left">peer1.org2.example.com</td>
<td>192.168.30.6</td>
<td align="center">org1</td>
<td align="center">123</td>
</tr>
<tr>
<td align="left">peer0.org1.example.com</td>
<td>192.168.30.7</td>
<td align="center">org2</td>
<td align="center">123</td>
</tr>
<tr>
<td align="left">peer1.org2.example.com</td>
<td>192.168.30.8</td>
<td align="center">org2</td>
<td align="center">123</td>
</tr>
<tr>
<td align="left">nfs-server</td>
<td>192.168.30.9</td>
<td align="center"></td>
<td align="center">123</td>
</tr>
</tbody></table>
<h1 id="网络拓扑"><a href="#网络拓扑" class="headerlink" title="网络拓扑"></a>网络拓扑</h1><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/img/raft/map.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<h1 id="配置这些虚拟机"><a href="#配置这些虚拟机" class="headerlink" title="配置这些虚拟机"></a>配置这些虚拟机</h1><p>由于虚拟机在不和本电脑在一个网段，若要通信需要配一个静态的本地IP（192.168.1.x）和一个虚拟机所在网段的IP地址（192.168.30.x）。</p>
<blockquote>
<p>ip配置如下。</p>
<p>192.168.1.200（路由器下的ip，供上网使用）</p>
<p>192.168.30.200（192.168.30.x，供连接虚拟机使用）</p>
</blockquote>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/img/raft/ip.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

<blockquote>
<p>注意保存。</p>
</blockquote>
<blockquote>
<p>win10下打开命令行，ping 一下虚拟机的ip测试连接情况。</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\cups&gt;ping 192.168.30.18</span><br><span class="line"></span><br><span class="line">正在 Ping 192.168.30.18 具有 32 字节的数据:</span><br><span class="line">来自 192.168.30.18 的回复: 字节=32 时间&lt;1ms TTL=64</span><br><span class="line">来自 192.168.30.18 的回复: 字节=32 时间&lt;1ms TTL=64</span><br><span class="line">来自 192.168.30.18 的回复: 字节=32 时间&lt;1ms TTL=64</span><br><span class="line"></span><br><span class="line">192.168.30.18 的 Ping 统计信息:</span><br><span class="line">    数据包: 已发送 = 3，已接收 = 3，丢失 = 0 (0% 丢失)，</span><br><span class="line">往返行程的估计时间(以毫秒为单位):</span><br><span class="line">    最短 = 0ms，最长 = 0ms，平均 = 0ms</span><br><span class="line">Control-C</span><br><span class="line">^C</span><br><span class="line">C:\Users\cups&gt;</span><br></pre></td></tr></table></figure>

<h2 id="（一）虚拟机基础环境配置"><a href="#（一）虚拟机基础环境配置" class="headerlink" title="（一）虚拟机基础环境配置"></a>（一）虚拟机基础环境配置</h2><h3 id="1、Xshell登录"><a href="#1、Xshell登录" class="headerlink" title="1、Xshell登录"></a>1、Xshell登录</h3><p>Xshell下载地址： <a href="https://www.netsarang.com/zh/xshell/" target="_blank" rel="noopener">https://www.netsarang.com/zh/xshell/</a> </p>
<p>Xshell登录流程： <a href="https://jingyan.baidu.com/article/624e7459032b4334e8ba5a33.html" target="_blank" rel="noopener">https://jingyan.baidu.com/article/624e7459032b4334e8ba5a33.html</a> </p>
<p>登录后输出如下所示。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Connecting to 192.168.30.18:22...</span><br><span class="line">Connection established.</span><br><span class="line">To escape to local shell, press 'Ctrl+Alt+]'.</span><br><span class="line">Last login: Sun Sep 27 20:31:53 2020 from 192.168.30.200</span><br><span class="line">[root@vm1921683018 ~]#</span><br></pre></td></tr></table></figure>

<h3 id="2、使虚拟机可以上网"><a href="#2、使虚拟机可以上网" class="headerlink" title="2、使虚拟机可以上网"></a>2、使虚拟机可以上网</h3><blockquote>
<p>原因：生成的虚拟机（内网）在192.168.30.x网段，无法上网。需要配置一个192.168.1.x网段的的ip地址才能上网。</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">###################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 切换到网络配置文件所在的路径</span></span><br><span class="line">cd /etc/sysconfig/network-scripts/</span><br><span class="line"><span class="meta">#</span><span class="bash"> 备份文件</span></span><br><span class="line">cp ifcfg-ens160  ifcfg-ens160.bat</span><br><span class="line"><span class="meta">#</span><span class="bash"> 更改文件</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 内容示例如下所示</span></span><br><span class="line">vim ifcfg-ens160</span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启虚拟机使更改生效；重启网络服务总是失败(.........)</span></span><br><span class="line">reboot</span><br><span class="line"><span class="meta">#</span><span class="bash"> 等待片刻从新连接虚拟机</span></span><br><span class="line">ping www.baidu.com</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">###################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">###################配置文件示例</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">###################################################</span></span></span><br><span class="line">HWADDR=00:50:56:B8:D7:DC</span><br><span class="line">NAME=ens160</span><br><span class="line">GATEWAY=192.168.1.1			# 网关需要改为192.168.1.1</span><br><span class="line">DNS1=8.8.8.8</span><br><span class="line">DNS2=114.114.114.114</span><br><span class="line">DEVICE=ens160</span><br><span class="line">ONBOOT=yes</span><br><span class="line">USERCTL=no</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">NETMASK=255.255.255.0</span><br><span class="line">IPADDR=192.168.30.18</span><br><span class="line">PEERDNS=no</span><br><span class="line"><span class="meta">#</span><span class="bash"> 注销结束的标志</span></span><br><span class="line"><span class="meta">#</span><span class="bash">NM: <span class="function"><span class="title">check_link_down</span></span>() &#123;	</span></span><br><span class="line"><span class="meta">#</span><span class="bash">NM:  <span class="built_in">return</span> 1; </span></span><br><span class="line"><span class="meta">#</span><span class="bash">NM: &#125;</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加新的IP地址192.168.1.x</span></span><br><span class="line">TYPE=Ethernet</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">PREFIX=24</span><br><span class="line">IPADDR1=192.168.1.123</span><br><span class="line">PREFIX1=24</span><br><span class="line">NETMASK1=255.255.255.0</span><br><span class="line">DEFROUTE=yes</span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=no</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#################################################</span></span></span><br></pre></td></tr></table></figure>

<h3 id="3、防火墙"><a href="#3、防火墙" class="headerlink" title="3、防火墙"></a>3、防火墙</h3><p>关闭防火墙</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl status firewalld</span><br><span class="line">systemctl disable firewalld</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注：</p>
<p>1)设置防火墙</p>
<p><code>firewall-cmd --zone=public --permanent --add-port=5984/tcp --add-port=7050/tcp --add-port=7051/tcp --add-port=7052/tcp --add-port=7053/tcp --add-port=7054/tcp --add-port=8053/tcp --add-port=9053/tcp --add-port=10053/tcp</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@vm192168302 ~]# firewall-cmd --zone=public --permanent --add-port=5984/tcp --add-port=7050/tcp --add-port=7051/tcp --add-port=7052/tcp --add-port=7053/tcp --add-port=7054/tcp --add-port=8053/tcp --add-port=9053/tcp --add-port=10053/tcp</span><br><span class="line">success</span><br><span class="line">[root@vm192168302 ~]# </span><br></pre></td></tr></table></figure>

<p>2)重新载入</p>
<p><code>firewall-cmd --reload</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash">[root@vm192168302 ~]<span class="comment"># firewall-cmd --reload </span></span></span><br><span class="line">success</span><br><span class="line">[root@vm192168302 ~]# </span><br></pre></td></tr></table></figure>

<p>3)查看开放的端口</p>
<p> <code>firewall-cmd --zone=public --list-ports</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash">[root@vm192168302 ~]<span class="comment"># firewall-cmd --zone=public --list-ports </span></span></span><br><span class="line">5984/tcp 7050/tcp 7051/tcp 7052/tcp 7053/tcp 7054/tcp 8053/tcp 9053/tcp 10053/tcp</span><br><span class="line">[root@vm192168302 ~]# </span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="4、设置Selinux"><a href="#4、设置Selinux" class="headerlink" title="4、设置Selinux"></a>4、设置Selinux</h3><blockquote>
<p> SELinux(Security-Enhanced Linux) 是美国国家安全局（NSA）对于强制访问控制的实现，是 Linux历史上最杰出的新安全子系统。NSA是在Linux社区的帮助下开发了一种访问控制体系，在这种访问控制体系的限制下，进程只能访问那些在他的任务中所需要文件。SELinux 默认安装在 Fedora 和 Red Hat Enterprise Linux 上，也可以作为其他发行版上容易安装的包得到。 </p>
<p> 博客上都这么做，暂时不清楚为啥做。理解上就是关闭了这样个安全子系统。</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 通过命令获取状态 </span></span><br><span class="line">getenforce </span><br><span class="line"><span class="meta">#</span><span class="bash"> 命令行设置selinux，enforcing,permissive 或者 1,0。 </span></span><br><span class="line">getenforce 0 </span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看selinux的信息 </span></span><br><span class="line">sestatus -v </span><br><span class="line"><span class="meta">#</span><span class="bash"> 编辑配置 </span></span><br><span class="line">vi /etc/selinux/config</span><br><span class="line"><span class="meta">#</span><span class="bash">将配置中的 SELINUX=enforcing 改为 SELINUX=disabled</span></span><br></pre></td></tr></table></figure>

<h3 id="5、设置时间同步"><a href="#5、设置时间同步" class="headerlink" title="5、设置时间同步"></a>5、设置时间同步</h3><blockquote>
<p>进行时间同步</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 移除本地时间</span></span><br><span class="line">rm -rf /etc/localtime</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改时区</span></span><br><span class="line">ln -s /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置系统时钟</span></span><br><span class="line">echo "ZONE="Asia/Shanghai"</span><br><span class="line">UTC=false</span><br><span class="line">ARC=false"&gt;&gt;/etc/sysconfig/clock</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装时间服务</span></span><br><span class="line">yum install -y ntp</span><br><span class="line">systemctl start ntpd</span><br><span class="line">systemctl enable ntpd</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 时间同步指向阿里云时间服务器</span></span><br><span class="line">echo "/usr/sbin/ntpdate ntp1.aliyun.com &gt; /dev/null 2&gt;&amp;1; /sbin/hwclock -w"&gt;&gt;/etc/rc.d/rc.local</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 定时任务，每分钟同步一次</span></span><br><span class="line">echo "0 */1 * * * ntpdate ntp1.aliyun.com &gt; /dev/null 2&gt;&amp;1; /sbin/hwclock -w"&gt;&gt;/etc/cro</span><br></pre></td></tr></table></figure>

<h3 id="6、安装常用工具"><a href="#6、安装常用工具" class="headerlink" title="6、安装常用工具"></a>6、安装常用工具</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">yum install -y curl \</span><br><span class="line">wget \</span><br><span class="line">tree \</span><br><span class="line">lrzsz \</span><br><span class="line">dos2unix \</span><br><span class="line">git</span><br></pre></td></tr></table></figure>

<h3 id="7、更换软件源"><a href="#7、更换软件源" class="headerlink" title="7、更换软件源"></a>7、更换软件源</h3><blockquote>
<p>提升相关软件包下载速度</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 使用网易的镜像源</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 源存储目录</span></span><br><span class="line">cd /etc/yum.repos.d/</span><br><span class="line"><span class="meta">#</span><span class="bash"> 更改名称进行备份</span></span><br><span class="line">mv CentOS-Base.repo CentOS-Base.repo.ori</span><br><span class="line"><span class="meta">#</span><span class="bash"> 下载文件</span></span><br><span class="line">wget http://mirrors.163.com/.help/CentOS6-Base-163.repo</span><br><span class="line"><span class="meta">#</span><span class="bash"> 更改名称</span></span><br><span class="line">mv CentOS6-Base-163.repo CentOS-Base.repo</span><br><span class="line"><span class="meta">#</span><span class="bash"> 清空缓存</span></span><br><span class="line">yum -y clean all</span><br><span class="line"><span class="meta">#</span><span class="bash"> 更新 </span></span><br><span class="line">yum makecache</span><br></pre></td></tr></table></figure>

<h3 id="8、更改hosts文件"><a href="#8、更改hosts文件" class="headerlink" title="8、更改hosts文件"></a>8、更改hosts文件</h3><blockquote>
<p>默认域名IP的对应关系。</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/hosts</span><br><span class="line">192.168.30.12 ca.cpcc.com</span><br><span class="line">192.168.30.12 orderer0.cpcc.com</span><br><span class="line">192.168.30.13 orderer1.cpcc.com</span><br><span class="line">192.168.30.14 orderer2.cpcc.com</span><br><span class="line">192.168.30.14 peer0.ddc.com</span><br><span class="line">192.168.30.14 peer1.ddc.com</span><br><span class="line">192.168.30.14 peer2.ddc.com</span><br><span class="line">192.168.30.14 peer3.ddc.com</span><br><span class="line">192.168.30.15 peer0.owp.com</span><br><span class="line">192.168.30.15 peer1.owp.com</span><br><span class="line">192.168.30.15 peer2.owp.com</span><br><span class="line">192.168.30.15 peer3.owp.com</span><br><span class="line">192.168.30.16 peer0.leo.com</span><br><span class="line">192.168.30.16 peer1.leo.com</span><br><span class="line">192.168.30.16 peer2.leo.com</span><br><span class="line">192.168.30.16 peer3.leo.com</span><br></pre></td></tr></table></figure>

<h1 id="Fabric相关操作"><a href="#Fabric相关操作" class="headerlink" title="Fabric相关操作"></a>Fabric相关操作</h1><h2 id="（一）准备相关文件"><a href="#（一）准备相关文件" class="headerlink" title="（一）准备相关文件"></a>（一）准备相关文件</h2><h3 id="1、crypto-config-yaml"><a href="#1、crypto-config-yaml" class="headerlink" title="1、crypto-config.yaml"></a>1、crypto-config.yaml</h3><blockquote>
<p>供cryptogen模块解释执行生成相关证书。</p>
<p>这些证书一部分用以网络节点的启动，另一部分用作客户端证书。</p>
<p> 更多内容请参考： <a href="https://hyperledgercn.github.io/hyperledgerDocs/" target="_blank" rel="noopener">https://hyperledgercn.github.io/hyperledgerDocs/</a> </p>
</blockquote>
<p>建立文件夹kafka用于存储相关文件:<code>mkdir raft</code></p>
<p>进入生成的文件夹：<code>cd raft</code></p>
<p>新建crypto-config.yaml并写入如下内容：<code>vim crypto-config.yaml</code> </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">OrdererOrgs:</span><br><span class="line">  - Name: Orderer</span><br><span class="line">    Domain: example.com</span><br><span class="line">    EnableNodeOUs: true</span><br><span class="line">    CA:</span><br><span class="line">      Country: CN</span><br><span class="line">      Province: HeNan</span><br><span class="line">      Locality: ZhengZhou</span><br><span class="line">    Specs:</span><br><span class="line">      - Hostname: orderer0</span><br><span class="line">      - Hostname: orderer1</span><br><span class="line">      - Hostname: orderer2</span><br><span class="line"></span><br><span class="line">PeerOrgs:</span><br><span class="line">  - Name: Org1</span><br><span class="line">    Domain: org1.example.com</span><br><span class="line">    EnableNodeOUs: true</span><br><span class="line">    CA:</span><br><span class="line">      Country: CN</span><br><span class="line">      Province: HeNan</span><br><span class="line">      Locality: ZhengZhou</span><br><span class="line">    Template:</span><br><span class="line">      Count: 2</span><br><span class="line">    Users:</span><br><span class="line">      Count: 1</span><br><span class="line"></span><br><span class="line">  - Name: Org2</span><br><span class="line">    Domain: org2.example.com</span><br><span class="line">    EnableNodeOUs: true</span><br><span class="line">    CA:</span><br><span class="line">      Country: CN</span><br><span class="line">      Province: HeNan</span><br><span class="line">      Locality: ZhengZhou</span><br><span class="line">    Template:</span><br><span class="line">      Count: 2</span><br><span class="line">    Users:</span><br><span class="line">      Count: 1</span><br></pre></td></tr></table></figure>

<h3 id="2、configtx-yaml"><a href="#2、configtx-yaml" class="headerlink" title="2、configtx.yaml"></a>2、configtx.yaml</h3><blockquote>
<p> configtx.yaml是Hyperledger Fabric区块链网络运维工具configtxgen用于生成通道创世块或通道交易的配置文件，configtx.yaml的内容直接决定了所生成的创世区块的内容。 </p>
<p>更多内容请参考： <a href="https://segmentfault.com/a/1190000018990043?utm_source=tag-newest" target="_blank" rel="noopener">https://segmentfault.com/a/1190000018990043?utm_source=tag-newest</a> </p>
</blockquote>
<p>新建configtx.yaml 并写入如下内容：<code>vim configtx.yaml</code> </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line">Organizations:</span><br><span class="line">    - &amp;OrdererOrg</span><br><span class="line">        Name: OrdererOrg</span><br><span class="line">        ID: OrdererMSP</span><br><span class="line">        MSPDir: crypto-config/ordererOrganizations/example.com/msp</span><br><span class="line">        Policies:</span><br><span class="line">            Readers:</span><br><span class="line">                Type: Signature</span><br><span class="line">                Rule: "OR('OrdererMSP.member')"</span><br><span class="line">            Writers:</span><br><span class="line">                Type: Signature</span><br><span class="line">                Rule: "OR('OrdererMSP.member')"</span><br><span class="line">            Admins:</span><br><span class="line">                Type: Signature</span><br><span class="line">                Rule: "OR('OrdererMSP.admin')"</span><br><span class="line"></span><br><span class="line">    - &amp;Org1</span><br><span class="line">        Name: Org1MSP</span><br><span class="line">        ID: Org1MSP</span><br><span class="line">        MSPDir: crypto-config/peerOrganizations/org1.example.com/msp</span><br><span class="line">        Policies:</span><br><span class="line">            Readers:</span><br><span class="line">                Type: Signature</span><br><span class="line">                Rule: "OR('Org1MSP.admin', 'Org1MSP.peer', 'Org1MSP.client')"</span><br><span class="line">            Writers:</span><br><span class="line">                Type: Signature</span><br><span class="line">                Rule: "OR('Org1MSP.admin', 'Org1MSP.client')"</span><br><span class="line">            Admins:</span><br><span class="line">                Type: Signature</span><br><span class="line">                Rule: "OR('Org1MSP.admin')"</span><br><span class="line">            Endorsement:</span><br><span class="line">                Type: Signature</span><br><span class="line">                Rule: "OR('Org1MSP.peer')"</span><br><span class="line">        AnchorPeers:</span><br><span class="line">            - Host: peer0.org1.example.com</span><br><span class="line">              Port: 7051</span><br><span class="line"></span><br><span class="line">    - &amp;Org2</span><br><span class="line">        Name: Org2MSP</span><br><span class="line">        ID: Org2MSP</span><br><span class="line">        MSPDir: crypto-config/peerOrganizations/org2.example.com/msp</span><br><span class="line">        Policies:</span><br><span class="line">            Readers:</span><br><span class="line">                Type: Signature</span><br><span class="line">                Rule: "OR('Org2MSP.admin', 'Org2MSP.peer', 'Org2MSP.client')"</span><br><span class="line">            Writers:</span><br><span class="line">                Type: Signature</span><br><span class="line">                Rule: "OR('Org2MSP.admin', 'Org2MSP.client')"</span><br><span class="line">            Admins:</span><br><span class="line">                Type: Signature</span><br><span class="line">                Rule: "OR('Org2MSP.admin')"</span><br><span class="line">            Endorsement:</span><br><span class="line">                Type: Signature</span><br><span class="line">                Rule: "OR('Org2MSP.peer')"</span><br><span class="line">        AnchorPeers:</span><br><span class="line">            - Host: peer0.org2.example.com</span><br><span class="line">              Port: 7051</span><br><span class="line"></span><br><span class="line">Capabilities:</span><br><span class="line">    Channel: &amp;ChannelCapabilities</span><br><span class="line">        V2_0: true</span><br><span class="line">    Orderer: &amp;OrdererCapabilities</span><br><span class="line">        V2_0: true</span><br><span class="line">    Application: &amp;ApplicationCapabilities</span><br><span class="line">        V2_0: true</span><br><span class="line"></span><br><span class="line">Application: &amp;ApplicationDefaults</span><br><span class="line">    Organizations:</span><br><span class="line">    Policies:</span><br><span class="line">        Readers:</span><br><span class="line">            Type: ImplicitMeta</span><br><span class="line">            Rule: "ANY Readers"</span><br><span class="line">        Writers:</span><br><span class="line">            Type: ImplicitMeta</span><br><span class="line">            Rule: "ANY Writers"</span><br><span class="line">        Admins:</span><br><span class="line">            Type: ImplicitMeta</span><br><span class="line">            Rule: "MAJORITY Admins"</span><br><span class="line">        LifecycleEndorsement:</span><br><span class="line">            Type: ImplicitMeta</span><br><span class="line">            Rule: "MAJORITY Endorsement"</span><br><span class="line">        Endorsement:</span><br><span class="line">            Type: ImplicitMeta</span><br><span class="line">            Rule: "MAJORITY Endorsement"</span><br><span class="line">    Capabilities:</span><br><span class="line">        &lt;&lt;: *ApplicationCapabilities</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Orderer: &amp;OrdererDefaults</span><br><span class="line">    OrdererType: etcdraft</span><br><span class="line">    Addresses:</span><br><span class="line">        - orderer0.example.com:7050</span><br><span class="line">        - orderer1.example.com:7050</span><br><span class="line">        - orderer2.example.com:7050</span><br><span class="line">    BatchTimeout: 2s</span><br><span class="line">    BatchSize:</span><br><span class="line">        MaxMessageCount: 10</span><br><span class="line">        AbsoluteMaxBytes: 99 MB</span><br><span class="line">        PreferredMaxBytes: 512 KB</span><br><span class="line">    Kafka:</span><br><span class="line">        Brokers:</span><br><span class="line">            - 127.0.0.1:9092</span><br><span class="line">    EtcdRaft:</span><br><span class="line">        Consenters:</span><br><span class="line">            - Host: orderer0.example.com</span><br><span class="line">              Port: 7050</span><br><span class="line">              ClientTLSCert: crypto-config/ordererOrganizations/example.com/orderers/orderer0.example.com/tls/server.crt</span><br><span class="line">              ServerTLSCert: crypto-config/ordererOrganizations/example.com/orderers/orderer0.example.com/tls/server.crt</span><br><span class="line">            - Host: orderer1.example.com</span><br><span class="line">              Port: 7050</span><br><span class="line">              ClientTLSCert: crypto-config/ordererOrganizations/example.com/orderers/orderer1.example.com/tls/server.crt</span><br><span class="line">              ServerTLSCert: crypto-config/ordererOrganizations/example.com/orderers/orderer1.example.com/tls/server.crt</span><br><span class="line">            - Host: orderer2.example.com</span><br><span class="line">              Port: 7050</span><br><span class="line">              ClientTLSCert: crypto-config/ordererOrganizations/example.com/orderers/orderer2.example.com/tls/server.crt</span><br><span class="line">              ServerTLSCert: crypto-config/ordererOrganizations/example.com/orderers/orderer2.example.com/tls/server.crt</span><br><span class="line">    Organizations:</span><br><span class="line">    Policies:</span><br><span class="line">        Readers:</span><br><span class="line">            Type: ImplicitMeta</span><br><span class="line">            Rule: "ANY Readers"</span><br><span class="line">        Writers:</span><br><span class="line">            Type: ImplicitMeta</span><br><span class="line">            Rule: "ANY Writers"</span><br><span class="line">        Admins:</span><br><span class="line">            Type: ImplicitMeta</span><br><span class="line">            Rule: "MAJORITY Admins"</span><br><span class="line">        BlockValidation:</span><br><span class="line">            Type: ImplicitMeta</span><br><span class="line">            Rule: "ANY Writers"</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Channel: &amp;ChannelDefaults</span><br><span class="line">    Policies:</span><br><span class="line">        Readers:</span><br><span class="line">            Type: ImplicitMeta</span><br><span class="line">            Rule: "ANY Readers"</span><br><span class="line">        Writers:</span><br><span class="line">            Type: ImplicitMeta</span><br><span class="line">            Rule: "ANY Writers"</span><br><span class="line">        Admins:</span><br><span class="line">            Type: ImplicitMeta</span><br><span class="line">            Rule: "MAJORITY Admins"</span><br><span class="line">    Capabilities:</span><br><span class="line">        &lt;&lt;: *ChannelCapabilities</span><br><span class="line"></span><br><span class="line">Profiles:</span><br><span class="line"></span><br><span class="line">    TwoOrgsOrdererGenesis:</span><br><span class="line">        &lt;&lt;: *ChannelDefaults</span><br><span class="line">        Orderer:</span><br><span class="line">            &lt;&lt;: *OrdererDefaults</span><br><span class="line">            Organizations:</span><br><span class="line">                - *OrdererOrg</span><br><span class="line">            Capabilities:</span><br><span class="line">                &lt;&lt;: *OrdererCapabilities</span><br><span class="line">        Consortiums:</span><br><span class="line">            SampleConsortium:</span><br><span class="line">                Organizations:</span><br><span class="line">                    - *Org1</span><br><span class="line">                    - *Org2</span><br><span class="line">    TwoOrgsChannel:</span><br><span class="line">        Consortium: SampleConsortium</span><br><span class="line">        &lt;&lt;: *ChannelDefaults</span><br><span class="line">        Application:</span><br><span class="line">            &lt;&lt;: *ApplicationDefaults</span><br><span class="line">            Organizations:</span><br><span class="line">                - *Org1</span><br><span class="line">                - *Org2</span><br><span class="line">            Capabilities:</span><br><span class="line">                &lt;&lt;: *ApplicationCapabilities</span><br></pre></td></tr></table></figure>

<h3 id="3、生成公私钥和证书"><a href="#3、生成公私钥和证书" class="headerlink" title="3、生成公私钥和证书"></a>3、生成公私钥和证书</h3><blockquote>
<p>生成公私钥以及证书。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/cryptogen generate --config=./crypto-config.yaml</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="4、生成创世区块"><a href="#4、生成创世区块" class="headerlink" title="4、生成创世区块"></a>4、生成创世区块</h3><blockquote>
<p>创世区块中包含有网络信息。</p>
<p><strong>有区别：-channelID system</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir channel-artifacts</span><br><span class="line">./bin/configtxgen -profile TwoOrgsOrdererGenesis -outputBlock ./channel-artifacts/genesis.block -channelID system</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="5、生成通道配置区块"><a href="#5、生成通道配置区块" class="headerlink" title="5、生成通道配置区块"></a>5、生成通道配置区块</h3><blockquote>
<p>通道文件。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./channel-artifacts/mychannel.tx -channelID mychannel</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="5、更新锚节点"><a href="#5、更新锚节点" class="headerlink" title="5、更新锚节点"></a>5、更新锚节点</h3><blockquote>
<p>锚节点。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">./bin/configtxgen \</span><br><span class="line">-profile TwoOrgsChannel \</span><br><span class="line">-outputAnchorPeersUpdate ./channel-artifacts/DDCMSPanchors.tx \</span><br><span class="line">-channelID mychannel \</span><br><span class="line">-asOrg DDCMSP</span><br><span class="line"></span><br><span class="line">./bin/configtxgen \</span><br><span class="line">-profile TwoOrgsChannel \</span><br><span class="line">-outputAnchorPeersUpdate ./channel-artifacts/OWPMSPanchors.tx \</span><br><span class="line">-channelID mychannel \</span><br><span class="line">-asOrg OWPMSP</span><br><span class="line"></span><br><span class="line">./bin/configtxgen \</span><br><span class="line">-profile TwoOrgsChannel \</span><br><span class="line">-outputAnchorPeersUpdate ./channel-artifacts/LEOMSPanchors.tx \</span><br><span class="line">-channelID mychannel \</span><br><span class="line">-asOrg LEOMSP</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="6、复制文件"><a href="#6、复制文件" class="headerlink" title="6、复制文件"></a>6、复制文件</h3><blockquote>
<p>直接全部复制。</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /root</span><br><span class="line">scp -r registerofcopyright/ root@192.168.30.13:/root/</span><br></pre></td></tr></table></figure>

<h2 id="（二）启动网络"><a href="#（二）启动网络" class="headerlink" title="（二）启动网络"></a>（二）启动网络</h2><h3 id="1、启动orderer节点"><a href="#1、启动orderer节点" class="headerlink" title="1、启动orderer节点"></a>1、启动orderer节点</h3><blockquote>
<p>192.168.30.14====================&gt;docker-compose -f cpcc-orderer0.yaml up -d</p>
<p>192.168.30.15====================&gt;docker-compose -f cpcc-orderer1.yaml up -d</p>
<p>192.168.30.16====================&gt;docker-compose -f cpcc-orderer2.yaml up -d</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">docker-compose -f cpcc-orderer0.yaml up -d</span><br><span class="line">docker-compose -f cpcc-orderer1.yaml up -d</span><br><span class="line">docker-compose -f cpcc-orderer2.yaml up -d</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">################################################</span></span></span><br><span class="line">docker logs orderer0.cpcc.com</span><br><span class="line">docker logs orderer1.cpcc.com</span><br><span class="line">docker logs orderer2.cpcc.com</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">################################################</span></span></span><br><span class="line">docker-compose -f cpcc-orderer0.yaml down</span><br><span class="line">docker-compose -f cpcc-orderer1.yaml down</span><br><span class="line">docker-compose -f cpcc-orderer2.yaml down</span><br></pre></td></tr></table></figure>

<h3 id="2、启动peer节点"><a href="#2、启动peer节点" class="headerlink" title="2、启动peer节点"></a>2、启动peer节点</h3><blockquote>
<p>192.168.30.14====================&gt;docker-compose -f ddc-peer.yaml up -d</p>
<p>192.168.30.15====================&gt;docker-compose -f owp-peer.yaml up -d</p>
<p>192.168.30.16====================&gt;docker-compose -f leo-peer.yaml up -d</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">docker-compose -f ddc-peer.yaml up -d</span><br><span class="line">docker-compose -f owp-peer.yaml up -d</span><br><span class="line">docker-compose -f leo-peer.yaml up -d</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">################################################</span></span></span><br><span class="line">docker ps</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">################################################</span></span></span><br><span class="line">docker-compose -f ddc-peer.yaml down</span><br><span class="line">docker-compose -f owp-peer.yaml down</span><br><span class="line">docker-compose -f leo-peer.yaml down</span><br></pre></td></tr></table></figure>

<h3 id="3、将peer节点加入通道"><a href="#3、将peer节点加入通道" class="headerlink" title="3、将peer节点加入通道"></a>3、将peer节点加入通道</h3><blockquote>
<p>192.168.30.14==========================&gt;ddc</p>
<p>192.168.30.15==========================&gt;owp</p>
<p>192.168.30.16==========================&gt;jo</p>
<h3 id="（1）DDC-192-168-30-14"><a href="#（1）DDC-192-168-30-14" class="headerlink" title="（1）DDC-192.168.30.14"></a>（1）DDC-192.168.30.14</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">############# peer0.ddc.com创建并加入通道</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 进入客户端</span></span><br><span class="line">docker exec -it cli bash</span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建通道</span></span><br><span class="line">ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/cpcc.com/orderers/orderer0.cpcc.com/msp/tlscacerts/tlsca.cpcc.com-cert.pem</span><br><span class="line">peer channel create -o orderer0.cpcc.com:7050 -c mychannel -f ./channel-artifacts/mychannel.tx --tls --cafile $ORDERER_CA </span><br><span class="line"><span class="meta">#</span><span class="bash"> 加入通道</span></span><br><span class="line">peer channel join -b mychannel.block</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">############# peer1.ddc.com创建并加入通道</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> cli相关参数</span></span><br><span class="line">CORE_PEER_ADDRESS=peer1.ddc.com:8051</span><br><span class="line">CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/ddc.com/peers/peer1.ddc.com/tls/server.crt</span><br><span class="line">CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/ddc.com/peers/peer1.ddc.com/tls/server.key</span><br><span class="line">CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/ddc.com/peers/peer1.ddc.com/tls/ca.crt</span><br><span class="line"><span class="meta">#</span><span class="bash"> 加入通道</span></span><br><span class="line">peer channel join -b mychannel.block</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">############# peer2.ddc.com创建并加入通道</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> cli相关参数</span></span><br><span class="line">CORE_PEER_ADDRESS=peer2.ddc.com:9051</span><br><span class="line">CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/ddc.com/peers/peer2.ddc.com/tls/server.crt</span><br><span class="line">CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/ddc.com/peers/peer2.ddc.com/tls/server.key</span><br><span class="line">CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/ddc.com/peers/peer2.ddc.com/tls/ca.crt</span><br><span class="line"><span class="meta">#</span><span class="bash"> 加入通道</span></span><br><span class="line">peer channel join -b mychannel.block</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">############# peer3.ddc.com创建并加入通道</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> cli相关参数</span></span><br><span class="line">CORE_PEER_ADDRESS=peer3.ddc.com:10051</span><br><span class="line">CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/ddc.com/peers/peer3.ddc.com/tls/server.crt</span><br><span class="line">CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/ddc.com/peers/peer3.ddc.com/tls/server.key</span><br><span class="line">CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/ddc.com/peers/peer3.ddc.com/tls/ca.crt</span><br><span class="line"><span class="meta">#</span><span class="bash"> 加入通道</span></span><br><span class="line">peer channel join -b mychannel.block</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">############# 复制通道文件</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ctrl+D(退出客户端)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 从镜像复制到本地</span></span><br><span class="line">docker cp cli:/opt/gopath/src/github.com/hyperledger/fabric/peer/mychannel.block ./</span><br><span class="line"><span class="meta">#</span><span class="bash"> 传输给另外2台电脑</span></span><br><span class="line">scp ./mychannel.block root@192.168.30.15:/root/registerofcopyright</span><br><span class="line">scp ./mychannel.block root@192.168.30.16:/root/registerofcopyright</span><br></pre></td></tr></table></figure>

<h3 id="（2）OWP-192-168-30-15"><a href="#（2）OWP-192-168-30-15" class="headerlink" title="（2）OWP-192.168.30.15"></a>（2）OWP-192.168.30.15</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">############# 复制通道文件到cli</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line">docker cp ./mychannel.block cli:/opt/gopath/src/github.com/hyperledger/fabric/peer/</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">############# peer0.owp.com创建并加入通道</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 进入客户端</span></span><br><span class="line">docker exec -it cli bash</span><br><span class="line"><span class="meta">#</span><span class="bash"> 加入通道</span></span><br><span class="line">peer channel join -b mychannel.block</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">############# peer1.owp.com创建并加入通道</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> cli相关参数</span></span><br><span class="line">CORE_PEER_ADDRESS=peer1.owp.com:8051</span><br><span class="line">CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/owp.com/peers/peer1.owp.com/tls/server.crt</span><br><span class="line">CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/owp.com/peers/peer1.owp.com/tls/server.key</span><br><span class="line">CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/owp.com/peers/peer1.owp.com/tls/ca.crt</span><br><span class="line"><span class="meta">#</span><span class="bash"> 加入通道</span></span><br><span class="line">peer channel join -b mychannel.block</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">############# peer2.ddc.com创建并加入通道</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> cli相关参数</span></span><br><span class="line">CORE_PEER_ADDRESS=peer2.owp.com:9051</span><br><span class="line">CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/owp.com/peers/peer2.owp.com/tls/server.crt</span><br><span class="line">CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/owp.com/peers/peer2.owp.com/tls/server.key</span><br><span class="line">CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/owp.com/peers/peer2.owp.com/tls/ca.crt</span><br><span class="line"><span class="meta">#</span><span class="bash"> 加入通道</span></span><br><span class="line">peer channel join -b mychannel.block</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">############# peer3.ddc.com创建并加入通道</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> cli相关参数</span></span><br><span class="line">CORE_PEER_ADDRESS=peer3.owp.com:10051</span><br><span class="line">CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/owp.com/peers/peer3.owp.com/tls/server.crt</span><br><span class="line">CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/owp.com/peers/peer3.owp.com/tls/server.key</span><br><span class="line">CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/owp.com/peers/peer3.owp.com/tls/ca.crt</span><br><span class="line"><span class="meta">#</span><span class="bash"> 加入通道</span></span><br><span class="line">peer channel join -b mychannel.block</span><br></pre></td></tr></table></figure>

<h3 id="（3）LEO-192-168-30-16"><a href="#（3）LEO-192-168-30-16" class="headerlink" title="（3）LEO-192.168.30.16"></a>（3）LEO-192.168.30.16</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">############# 复制通道文件到cli</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line">docker cp ./mychannel.block cli:/opt/gopath/src/github.com/hyperledger/fabric/peer/</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">############# peer0.leo.com创建并加入通道</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 进入客户端</span></span><br><span class="line">docker exec -it cli bash</span><br><span class="line"><span class="meta">#</span><span class="bash"> 加入通道</span></span><br><span class="line">peer channel join -b mychannel.block</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">############# peer1.leo.com创建并加入通道</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> cli相关参数</span></span><br><span class="line">CORE_PEER_ADDRESS=peer1.leo.com:8051</span><br><span class="line">CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/leo.com/peers/peer1.leo.com/tls/server.crt</span><br><span class="line">CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/leo.com/peers/peer1.leo.com/tls/server.key</span><br><span class="line">CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/leo.com/peers/peer1.leo.com/tls/ca.crt</span><br><span class="line"><span class="meta">#</span><span class="bash"> 加入通道</span></span><br><span class="line">peer channel join -b mychannel.block</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">############# peer2.leo.com创建并加入通道</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> cli相关参数</span></span><br><span class="line">CORE_PEER_ADDRESS=peer2.leo.com:9051</span><br><span class="line">CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/leo.com/peers/peer2.leo.com/tls/server.crt</span><br><span class="line">CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/leo.com/peers/peer2.leo.com/tls/server.key</span><br><span class="line">CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/leo.com/peers/peer2.leo.com/tls/ca.crt</span><br><span class="line"><span class="meta">#</span><span class="bash"> 加入通道</span></span><br><span class="line">peer channel join -b mychannel.block</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">############# peer3.leo.com创建并加入通道</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> cli相关参数</span></span><br><span class="line">CORE_PEER_ADDRESS=peer3.leo.com:10051</span><br><span class="line">CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/leo.com/peers/peer3.leo.com/tls/server.crt</span><br><span class="line">CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/leo.com/peers/peer3.leo.com/tls/server.key</span><br><span class="line">CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/leo.com/peers/peer3.leo.com/tls/ca.crt</span><br><span class="line"><span class="meta">#</span><span class="bash"> 加入通道</span></span><br><span class="line">peer channel join -b mychannel.block</span><br></pre></td></tr></table></figure>

</blockquote>
<h3 id="4、更新锚节点"><a href="#4、更新锚节点" class="headerlink" title="4、更新锚节点"></a>4、更新锚节点</h3><blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">##############################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">########################## peer0.ddc.com</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">##############################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 进入客户端镜像</span></span><br><span class="line">docker exec -it cli bash</span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置相关参数</span></span><br><span class="line">CORE_PEER_ADDRESS=peer0.ddc.com:7051</span><br><span class="line">CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/ddc.com/peers/peer0.ddc.com/tls/server.crt</span><br><span class="line">CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/ddc.com/peers/peer0.ddc.com/tls/server.key</span><br><span class="line">CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/ddc.com/peers/peer0.ddc.com/tls/ca.crt</span><br><span class="line"><span class="meta">#</span><span class="bash"> 更新锚节点</span></span><br><span class="line">ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/cpcc.com/orderers/orderer0.cpcc.com/msp/tlscacerts/tlsca.cpcc.com-cert.pem</span><br><span class="line">peer channel update \</span><br><span class="line">-o orderer0.cpcc.com:7050 \</span><br><span class="line">-c mychannel \</span><br><span class="line">-f ./channel-artifacts/DDCMSPanchors.tx \</span><br><span class="line">--tls \</span><br><span class="line">--cafile $ORDERER_CA</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">##############################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">########################## peer0.owp.com</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">##############################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 进入客户端镜像</span></span><br><span class="line">docker exec -it cli bash</span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置相关参数</span></span><br><span class="line">CORE_PEER_ADDRESS=peer0.owp.com:7051</span><br><span class="line">CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/owp.com/peers/peer0.owp.com/tls/server.crt</span><br><span class="line">CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/owp.com/peers/peer0.owp.com/tls/server.key</span><br><span class="line">CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/owp.com/peers/peer0.owp.com/tls/ca.crt</span><br><span class="line"><span class="meta">#</span><span class="bash"> 更新锚节点</span></span><br><span class="line">ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/cpcc.com/orderers/orderer0.cpcc.com/msp/tlscacerts/tlsca.cpcc.com-cert.pem</span><br><span class="line">peer channel update \</span><br><span class="line">-o orderer0.cpcc.com:7050 \</span><br><span class="line">-c mychannel \</span><br><span class="line">-f ./channel-artifacts/OWPMSPanchors.tx \</span><br><span class="line">--tls \</span><br><span class="line">--cafile $ORDERER_CA</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">##############################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">########################## peer0.leo.com</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">##############################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 进入客户端镜像</span></span><br><span class="line">docker exec -it cli bash</span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置相关参数</span></span><br><span class="line">CORE_PEER_ADDRESS=peer0.leo.com:7051</span><br><span class="line">CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/leo.com/peers/peer0.leo.com/tls/server.crt</span><br><span class="line">CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/leo.com/peers/peer0.leo.com/tls/server.key</span><br><span class="line">CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/leo.com/peers/peer0.leo.com/tls/ca.crt</span><br><span class="line"><span class="meta">#</span><span class="bash"> 更新锚节点</span></span><br><span class="line">ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/cpcc.com/orderers/orderer0.cpcc.com/msp/tlscacerts/tlsca.cpcc.com-cert.pem</span><br><span class="line">peer channel update \</span><br><span class="line">-o orderer0.cpcc.com:7050 \</span><br><span class="line">-c mychannel \</span><br><span class="line">-f ./channel-artifacts/LEOMSPanchors.tx \</span><br><span class="line">--tls \</span><br><span class="line">--cafile $ORDERER_CA</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="（三）链码"><a href="#（三）链码" class="headerlink" title="（三）链码"></a>（三）链码</h2><h3 id="1、安装链码"><a href="#1、安装链码" class="headerlink" title="1、安装链码"></a>1、安装链码</h3><blockquote>
<h3 id="（1）DDC-192-168-30-14-1"><a href="#（1）DDC-192-168-30-14-1" class="headerlink" title="（1）DDC-192.168.30.14"></a>（1）DDC-192.168.30.14</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">##############################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">########################## peer2.ddc.com</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">##############################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置相关参数</span></span><br><span class="line">CORE_PEER_ADDRESS=peer2.ddc.com:9051</span><br><span class="line">CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/ddc.com/peers/peer2.ddc.com/tls/server.crt</span><br><span class="line">CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/ddc.com/peers/peer2.ddc.com/tls/server.key</span><br><span class="line">CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/ddc.com/peers/peer2.ddc.com/tls/ca.crt</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装智能合约</span></span><br><span class="line">peer chaincode install \</span><br><span class="line">-n aaa \</span><br><span class="line">-p github.com/hyperledger/fabric/chaincode/chaincode_example02 \</span><br><span class="line">-v 1.0</span><br><span class="line"><span class="meta">#</span><span class="bash"> 实例化智能合约</span></span><br><span class="line">ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/cpcc.com/orderers/orderer0.cpcc.com/msp/tlscacerts/tlsca.cpcc.com-cert.pem</span><br><span class="line">peer chaincode instantiate \</span><br><span class="line">-o orderer0.cpcc.com:7050 \</span><br><span class="line">--tls \</span><br><span class="line">--cafile $ORDERER_CA \</span><br><span class="line">-C mychannel \</span><br><span class="line">-n aaa \</span><br><span class="line">-v 1.0 \</span><br><span class="line">-c '&#123;"Args":["init","a","200","b","400"]&#125;' \</span><br><span class="line">-P "AND ('OWPMSP.peer','LEOMSP.peer')"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查询a、b的值</span></span><br><span class="line">peer chaincode query -C mychannel -n aaa -c '&#123;"Args":["query","a"]&#125;'</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<h3 id="（2）OWP-192-168-30-15-1"><a href="#（2）OWP-192-168-30-15-1" class="headerlink" title="（2）OWP-192.168.30.15"></a>（2）OWP-192.168.30.15</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">##############################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">########################## peer2.owp.com</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">##############################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置相关参数</span></span><br><span class="line">CORE_PEER_ADDRESS=peer2.owp.com:9051</span><br><span class="line">CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/owp.com/peers/peer2.owp.com/tls/server.crt</span><br><span class="line">CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/owp.com/peers/peer2.owp.com/tls/server.key</span><br><span class="line">CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/owp.com/peers/peer2.owp.com/tls/ca.crt</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装智能合约</span></span><br><span class="line">peer chaincode install \</span><br><span class="line">-n mycc \</span><br><span class="line">-p github.com/hyperledger/fabric/chaincode/chaincode_example02 \</span><br><span class="line">-v 1.0</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查询a、b的值</span></span><br><span class="line">peer chaincode query -C mychannel -n mycc -c '&#123;"Args":["query","a"]&#125;'</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<h3 id="（3）LEO-192-168-30-16-1"><a href="#（3）LEO-192-168-30-16-1" class="headerlink" title="（3）LEO-192.168.30.16"></a>（3）LEO-192.168.30.16</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">########################## peer2.jo.com</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> cli相关参数</span></span><br><span class="line">CORE_PEER_ADDRESS=peer2.leo.com:9051</span><br><span class="line">CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/leo.com/peers/peer2.leo.com/tls/server.crt</span><br><span class="line">CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/leo.com/peers/peer2.leo.com/tls/server.key</span><br><span class="line">CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/leo.com/peers/peer2.leo.com/tls/ca.crt</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装智能合约</span></span><br><span class="line">peer chaincode install \</span><br><span class="line">-n mycc \</span><br><span class="line">-p github.com/hyperledger/fabric/chaincode/chaincode_example02 \</span><br><span class="line">-v 1.0</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查询a、b的值</span></span><br><span class="line">peer chaincode query -C mychannel -n mycc -c '&#123;"Args":["query","a"]&#125;'</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="2、测试链码"><a href="#2、测试链码" class="headerlink" title="2、测试链码"></a>2、测试链码</h3><blockquote>
<p>测试链码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it  cli /bin/bash</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">########################################################################</span></span></span><br><span class="line">CORE_PEER_ADDRESS=peer2.ddc.com:9051</span><br><span class="line">CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/ddc.com/peers/peer2.ddc.com/tls/server.crt</span><br><span class="line">CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/ddc.com/peers/peer2.ddc.com/tls/server.key</span><br><span class="line">CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/ddc.com/peers/peer2.ddc.com/tls/ca.crt</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">########################################################################</span></span></span><br><span class="line">ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/cpcc.com/orderers/orderer0.cpcc.com/msp/tlscacerts/tlsca.cpcc.com-cert.pem</span><br><span class="line">peer chaincode invoke \</span><br><span class="line">-o orderer0.cpcc.com:7050 \</span><br><span class="line">--tls \</span><br><span class="line">--cafile $ORDERER_CA \</span><br><span class="line">--peerAddresses peer0.owp.com:7051 \</span><br><span class="line">--tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/owp.com/peers/peer0.owp.com/tls/ca.crt \</span><br><span class="line">--peerAddresses peer0.leo.com:7051 \</span><br><span class="line">--tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/leo.com/peers/peer0.leo.com/tls/ca.crt \</span><br><span class="line">-C mychannel \</span><br><span class="line">-n aaa \</span><br><span class="line">-c '&#123;"Args":["invoke","a","b","100"]&#125;'</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">########################################################################</span></span></span><br><span class="line">ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/cpcc.com/orderers/orderer0.cpcc.com/msp/tlscacerts/tlsca.cpcc.com-cert.pem</span><br><span class="line">peer chaincode invoke \</span><br><span class="line">-o orderer0.cpcc.com:7050 \</span><br><span class="line">--tls \</span><br><span class="line">--cafile $ORDERER_CA \</span><br><span class="line">--peerAddresses peer2.ddc.com:9051 \</span><br><span class="line">--tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/ddc.com/peers/peer2.ddc.com/tls/ca.crt \</span><br><span class="line">--peerAddresses peer2.owp.com:9051 \</span><br><span class="line">--tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/owp.com/peers/peer2.owp.com/tls/ca.crt \</span><br><span class="line">--peerAddresses peer2.leo.com:9051 \</span><br><span class="line">--tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/leo.com/peers/peer2.leo.com/tls/ca.crt \</span><br><span class="line">-C mychannel \</span><br><span class="line">-n cups \</span><br><span class="line">-c '&#123;"Args":["query","a"]&#125;'</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">########################################################################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查询a、b的值</span></span><br><span class="line">peer chaincode query -C mychannel -n mycc -c '&#123;"Args":["query","a"]&#125;'</span><br><span class="line">peer chaincode query -C mychannel -n mycc -c '&#123;"Args":["query","b"]&#125;'</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">#######################################################################</span></span></span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"><span class="comment"># 安装智能合约</span></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">peer chaincode install \</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">-n enregister \</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">-p github.com/hyperledger/fabric/chaincode/enregister \</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">-v 1.0</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"><span class="comment"># 实例化智能合约</span></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/cpcc.com/orderers/orderer0.cpcc.com/msp/tlscacerts/tlsca.cpcc.com-cert.pem</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">peer chaincode instantiate \</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">-o orderer0.cpcc.com:7050 \</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">--tls \</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">--cafile <span class="variable">$ORDERER_CA</span> \</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">-C mychannel \</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">-n enregister \</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">-v 1.0 \</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">-c <span class="string">'&#123;"Args":["init"]&#125;'</span> \</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">-P <span class="string">"AND ('DCCMSP.peer','OWPMSP.peer')"</span></span></span><br></pre></td></tr></table></figure>

</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<blockquote>
</blockquote>
<h1 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h1><blockquote>
<h2 id="清空所有容器"><a href="#清空所有容器" class="headerlink" title="清空所有容器"></a>清空所有容器</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo docker stop $(docker ps -a -q)</span><br><span class="line">sudo docker ps -qa|xargs docker rm</span><br><span class="line">cd /var/lib/docker/volumes</span><br><span class="line">rm -rf ./*</span><br><span class="line">rm -rf /root/.local/share/Trash/files</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<h2 id="清空所有镜像"><a href="#清空所有镜像" class="headerlink" title="清空所有镜像"></a>清空所有镜像</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker image rm -f $(docker images -a -q)</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<h2 id="清理挂载卷"><a href="#清理挂载卷" class="headerlink" title="清理挂载卷"></a>清理挂载卷</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /var/lib/docker/volumes</span><br><span class="line">rm -rf ./*</span><br><span class="line">rm -rf /root/.local/share/Trash/files</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<h2 id="清理项目文件"><a href="#清理项目文件" class="headerlink" title="清理项目文件"></a>清理项目文件</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">rm -rf raft</span><br><span class="line">rm -rf /root/.local/share/Trash/files</span><br></pre></td></tr></table></figure>
</blockquote>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2021-10-03T10:23:29.610Z" itemprop="dateUpdated">2021-10-03 18:23:29</time>
</span><br>


        
    </div>
    
    <footer>
        <a href="http://cupswen.github.io">
            <img src="/img/the_Huanghe_River.png" alt="CupsWen">
            CupsWen
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            

            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://cupswen.github.io/2021/03/22/2021/RegisterOfCopyright/&title=《2021/RegisterOfCopyright》 — Cups&pic=http://cupswen.github.io/img/the_Huanghe_River.png" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://cupswen.github.io/2021/03/22/2021/RegisterOfCopyright/&title=《2021/RegisterOfCopyright》 — Cups&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://cupswen.github.io/2021/03/22/2021/RegisterOfCopyright/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《2021/RegisterOfCopyright》 — Cups&url=http://cupswen.github.io/2021/03/22/2021/RegisterOfCopyright/&via=http://cupswen.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://cupswen.github.io/2021/03/22/2021/RegisterOfCopyright/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2021/10/03/2021/Ods/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">原创性检测服务器</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2020/10/12/2020/raft(1.4.3)/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Raft集群部署(Fabric1.4.3)</h4>
      </a>
    </div>
  
</nav>



    




















</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
            <span>This blog is licensed under a <a rel="license noopener" href="https://creativecommons.org/licenses/by/4.0/" target="_blank">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>CupsWen &copy; 2019 - 2021</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme indigo.</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://cupswen.github.io/2021/03/22/2021/RegisterOfCopyright/&title=《2021/RegisterOfCopyright》 — Cups&pic=http://cupswen.github.io/img/the_Huanghe_River.png" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://cupswen.github.io/2021/03/22/2021/RegisterOfCopyright/&title=《2021/RegisterOfCopyright》 — Cups&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://cupswen.github.io/2021/03/22/2021/RegisterOfCopyright/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《2021/RegisterOfCopyright》 — Cups&url=http://cupswen.github.io/2021/03/22/2021/RegisterOfCopyright/&via=http://cupswen.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://cupswen.github.io/2021/03/22/2021/RegisterOfCopyright/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=http://cupswen.github.io/2021/03/22/2021/RegisterOfCopyright/" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = 'Cups';
            clearTimeout(titleTime);
        } else {
            document.title = 'Cups';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
